(function(){"use strict";var e={8764:function(e,t,o){var a=o(5130),n=o(6768);const s={id:"app"};function l(e,t,o,a,l,i){const r=(0,n.g2)("TopNavbar"),d=(0,n.g2)("SidebarPage"),c=(0,n.g2)("SidebarBackend"),u=(0,n.g2)("router-view");return(0,n.uX)(),(0,n.CE)("div",s,[!i.isBackend&&i.showTopNavbar?((0,n.uX)(),(0,n.Wv)(r,{key:0})):(0,n.Q3)("",!0),i.isBackend||e.$route.meta.hideSidebar?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.Wv)(d,{key:1})),i.isBackend&&!e.$route.meta.hideSidebar?((0,n.uX)(),(0,n.Wv)(c,{key:2,isSidebarActive:l.isSidebarActive,onToggleSidebar:i.toggleSidebar},null,8,["isSidebarActive","onToggleSidebar"])):(0,n.Q3)("",!0),(0,n.bF)(u)])}var i=o(4232);const r={class:"navbar"},d={class:"navbar-title"},c={key:0,class:"export-container"},u={key:0,class:"export-menu"};function p(e,t,o,a,s,l){return(0,n.uX)(),(0,n.CE)("nav",r,[(0,n.Lk)("div",d,(0,i.v_)(l.currentRouteName),1),l.isHomePage?((0,n.uX)(),(0,n.CE)("div",c,[(0,n.Lk)("button",{class:"export-button",onClick:t[0]||(t[0]=(...e)=>l.toggleExportMenu&&l.toggleExportMenu(...e))},"匯出"),s.showExportMenu?((0,n.uX)(),(0,n.CE)("div",u,[(0,n.Lk)("button",{onClick:t[1]||(t[1]=e=>l.exportFile("pdf"))},"匯出PDF"),(0,n.Lk)("button",{onClick:t[2]||(t[2]=e=>l.exportFile("excel"))},"匯出Excel")])):(0,n.Q3)("",!0)])):(0,n.Q3)("",!0)])}var m={data(){return{showExportMenu:!1}},computed:{currentRouteName(){return this.$route.name},isHomePage(){return"首頁"===this.$route.name}},methods:{toggleExportMenu(){this.showExportMenu=!this.showExportMenu},exportFile(e){this.$emit("export",e),this.showExportMenu=!1}}},h=o(1241);const k=(0,h.A)(m,[["render",p],["__scopeId","data-v-1ed8ac7f"]]);var b=k;const f=e=>((0,n.Qi)("data-v-1d0bf5f1"),e=e(),(0,n.jt)(),e),v={class:"sidebar-header"},L={key:0},g=f((()=>(0,n.Lk)("span",{class:"text"},"儀錶板管理",-1))),C=f((()=>(0,n.Lk)("span",{class:"text"},"個人資訊",-1))),y=f((()=>(0,n.Lk)("span",{class:"text"},"帳號設定",-1))),w=f((()=>(0,n.Lk)("span",{class:"text"},"歷史紀錄",-1))),_=f((()=>(0,n.Lk)("span",{class:"text"},"登出",-1)));function M(e,t,o,s,l,r){const d=(0,n.g2)("font-awesome-icon"),c=(0,n.g2)("router-link");return(0,n.uX)(),(0,n.CE)("div",null,[(0,n.Lk)("div",{class:(0,i.C4)(["sidebar",{open:l.isSidebarOpen}])},[(0,n.Lk)("div",v,[(0,n.bF)(d,{icon:"user",class:"icon"}),l.isSidebarOpen?((0,n.uX)(),(0,n.CE)("span",L,"王曉明")):(0,n.Q3)("",!0),(0,n.Lk)("span",{class:"toggle-btn",onClick:t[0]||(t[0]=(...e)=>r.toggleSidebar&&r.toggleSidebar(...e))},"☰")]),(0,n.bF)(c,{to:"/frontend/home","data-tooltip":"儀錶板管理"},{default:(0,n.k6)((()=>[(0,n.bF)(d,{icon:"tachometer-alt",class:"icon"}),g])),_:1}),(0,n.bF)(c,{to:"/frontend/profile","data-tooltip":"個人資訊"},{default:(0,n.k6)((()=>[(0,n.bF)(d,{icon:"user",class:"icon"}),C])),_:1}),(0,n.bF)(c,{to:"/frontend/accountsettings","data-tooltip":"帳號設定"},{default:(0,n.k6)((()=>[(0,n.bF)(d,{icon:"users",class:"icon"}),y])),_:1}),(0,n.bF)(c,{to:"/frontend/history","data-tooltip":"歷史紀錄"},{default:(0,n.k6)((()=>[(0,n.bF)(d,{icon:"history",class:"icon"}),w])),_:1}),(0,n.Lk)("a",{href:"#",onClick:t[1]||(t[1]=(0,a.D$)(((...e)=>r.confirmLogout&&r.confirmLogout(...e)),["prevent"])),"data-tooltip":"登出"},[(0,n.bF)(d,{icon:"sign-out-alt",class:"icon"}),_])],2),(0,n.Lk)("div",{class:(0,i.C4)(["content",{shift:l.isSidebarOpen}])},[(0,n.RG)(e.$slots,"default",{},void 0,!0)],2)])}o(4114);var P={name:"SidebarPage",data(){return{isSidebarOpen:!1}},methods:{toggleSidebar(){this.isSidebarOpen=!this.isSidebarOpen},confirmLogout(){const e=confirm("確定要登出嗎？");e&&this.logout()},logout(){alert("已登出"),this.$router.push("/frontend/login")}}};const E=(0,h.A)(P,[["render",M],["__scopeId","data-v-1d0bf5f1"]]);var R=E;const S=e=>((0,n.Qi)("data-v-6ffe4a4a"),e=e(),(0,n.jt)(),e),U=S((()=>(0,n.Lk)("div",{class:"hamburger-icon"},"☰",-1))),A=[U],V=S((()=>(0,n.Lk)("h2",null,"管理介面",-1)));function x(e,t,o,a,s,l){const r=(0,n.g2)("router-link");return(0,n.uX)(),(0,n.CE)("div",null,[(0,n.Lk)("div",{class:"hamburger-menu",onClick:t[0]||(t[0]=(...e)=>l.toggleSidebar&&l.toggleSidebar(...e))},A),(0,n.Lk)("div",{class:(0,i.C4)(["sidebar",{active:o.isSidebarActive}])},[V,(0,n.bF)(r,{to:"/backend/dashboard"},{default:(0,n.k6)((()=>[(0,n.eW)("儀錶板管理")])),_:1}),(0,n.bF)(r,{to:"/backend/user-management"},{default:(0,n.k6)((()=>[(0,n.eW)("用戶管理")])),_:1}),(0,n.bF)(r,{to:"/backend/role-management"},{default:(0,n.k6)((()=>[(0,n.eW)("角色管理")])),_:1}),(0,n.bF)(r,{to:"/backend/history"},{default:(0,n.k6)((()=>[(0,n.eW)("歷史紀錄")])),_:1}),(0,n.bF)(r,{to:"/backend/preferences"},{default:(0,n.k6)((()=>[(0,n.eW)("個人偏好")])),_:1}),(0,n.bF)(r,{to:"/backend/profile"},{default:(0,n.k6)((()=>[(0,n.eW)("個人資料")])),_:1}),(0,n.Lk)("button",{class:"logout-btn",onClick:t[1]||(t[1]=(...e)=>l.logout&&l.logout(...e))},"登出")],2)])}var F={props:{isSidebarActive:{type:Boolean,default:!1}},methods:{toggleSidebar(){this.$emit("toggle-sidebar")},logout(){this.$router.push("/backend/login")}}};const T=(0,h.A)(F,[["render",x],["__scopeId","data-v-6ffe4a4a"]]);var $=T,I={name:"App",components:{TopNavbar:b,SidebarPage:R,SidebarBackend:$},data(){return{isSidebarActive:!1}},computed:{isBackend(){return this.$route.path.startsWith("/backend")},showTopNavbar(){return!this.isBackend&&!this.$route.meta.hideNavbar}},methods:{toggleSidebar(){this.isSidebarActive=!this.isSidebarActive}}};const X=(0,h.A)(I,[["render",l]]);var q=X,B=o(1387);const D=e=>((0,n.Qi)("data-v-c452369e"),e=e(),(0,n.jt)(),e),J={class:"login-container"},N={class:"login-form"},W=D((()=>(0,n.Lk)("h2",null,"用戶登入",-1))),j={class:"input-group"},Q=D((()=>(0,n.Lk)("label",{for:"email"},"電子郵件",-1))),z={class:"input-group"},O=D((()=>(0,n.Lk)("label",{for:"password"},"密碼",-1))),H={class:"input-container"},K={class:"additional-options"},Z=D((()=>(0,n.Lk)("input",{type:"submit",value:"登入",class:"submit-button"},null,-1))),G={id:"login-feedback",class:"feedback"};function Y(e,t,o,s,l,r){const d=(0,n.g2)("router-link");return(0,n.uX)(),(0,n.CE)("div",J,[(0,n.Lk)("div",N,[W,(0,n.Lk)("form",{onSubmit:t[4]||(t[4]=(0,a.D$)(((...e)=>r.handleLogin&&r.handleLogin(...e)),["prevent"]))},[(0,n.Lk)("div",j,[Q,(0,n.bo)((0,n.Lk)("input",{type:"email",id:"email","onUpdate:modelValue":t[0]||(t[0]=e=>l.email=e),required:""},null,512),[[a.Jo,l.email]])]),(0,n.Lk)("div",z,[O,(0,n.Lk)("div",H,[(0,n.bo)((0,n.Lk)("input",{type:"password",id:"password","onUpdate:modelValue":t[1]||(t[1]=e=>l.password=e),required:""},null,512),[[a.Jo,l.password]]),(0,n.Lk)("i",{class:"fas fa-eye toggle-password",onClick:t[2]||(t[2]=e=>r.togglePasswordVisibility("password"))})])]),(0,n.Lk)("div",K,[(0,n.Lk)("label",null,[(0,n.bo)((0,n.Lk)("input",{type:"checkbox",id:"rememberMe","onUpdate:modelValue":t[3]||(t[3]=e=>l.rememberMe=e)},null,512),[[a.lH,l.rememberMe]]),(0,n.eW)(" 記住我 ")]),(0,n.bF)(d,{to:"/frontend/forgot_password"},{default:(0,n.k6)((()=>[(0,n.eW)("忘記密碼?")])),_:1})]),Z,(0,n.Lk)("div",G,(0,i.v_)(l.loginFeedback),1)],32),(0,n.Lk)("p",null,[(0,n.eW)("還未擁有帳號？ "),(0,n.bF)(d,{to:"/frontend/register"},{default:(0,n.k6)((()=>[(0,n.eW)("註冊")])),_:1})])])])}var ee=o(4373),te={data(){return{email:"",password:"",rememberMe:!1,loginFeedback:""}},methods:{async handleLogin(){try{const e=await ee.A.post("http://127.0.0.1:8000/api/token/",{email:this.email,password:this.password});200===e.status&&(localStorage.setItem("token",e.data.access),localStorage.setItem("position",e.data.position),localStorage.setItem("branch_id",e.data.branch_id),this.rememberMe?localStorage.setItem("refreshToken",e.data.refresh):sessionStorage.setItem("refreshToken",e.data.refresh),this.loginFeedback="登入成功",this.redirectUserBasedOnPosition())}catch(e){e.response&&e.response.data?this.loginFeedback=e.response.data.detail||"登入失敗，請檢查您的電子郵件和密碼":this.loginFeedback="登入失敗，請稍後再試"}},togglePasswordVisibility(e){const t=document.getElementById(e);"password"===t.type?t.type="text":t.type="password"},redirectUserBasedOnPosition(){const e=localStorage.getItem("position");"經理"===e?this.$router.push("/frontend/manager_dashboard"):"員工"===e?this.$router.push("/frontend/employee_dashboard"):this.$router.push("/frontend/home")}}};const oe=(0,h.A)(te,[["render",Y],["__scopeId","data-v-c452369e"]]);var ae=oe;const ne=e=>((0,n.Qi)("data-v-20fb3f5e"),e=e(),(0,n.jt)(),e),se={class:"content",id:"content"},le={class:"container"},ie=ne((()=>(0,n.Lk)("h2",null,"註冊",-1))),re=ne((()=>(0,n.Lk)("label",{for:"username"},"用戶名",-1))),de=ne((()=>(0,n.Lk)("label",{for:"email"},"電子郵件",-1))),ce=ne((()=>(0,n.Lk)("label",{for:"verification_code"},"驗證碼",-1))),ue=ne((()=>(0,n.Lk)("label",{for:"password"},"密碼",-1))),pe={class:"password-container"},me=ne((()=>(0,n.Lk)("div",{class:"password-example"},"密碼必須包含至少8個字符，且包括大小寫字母、數字和特殊字符。例如：Password@123",-1))),he=ne((()=>(0,n.Lk)("label",{for:"confirm_password"},"確認密碼",-1))),ke={class:"password-container"},be=ne((()=>(0,n.Lk)("label",{for:"phone"},"電話號碼",-1))),fe=ne((()=>(0,n.Lk)("input",{type:"submit",value:"註冊",class:"submit-button"},null,-1)));function ve(e,t,o,s,l,r){return(0,n.uX)(),(0,n.CE)("div",se,[(0,n.Lk)("div",le,[ie,(0,n.Lk)("form",{onSubmit:t[9]||(t[9]=(0,a.D$)(((...e)=>r.handleSubmit&&r.handleSubmit(...e)),["prevent"]))},[re,(0,n.bo)((0,n.Lk)("input",{type:"text",id:"username","onUpdate:modelValue":t[0]||(t[0]=e=>l.username=e),required:""},null,512),[[a.Jo,l.username]]),de,(0,n.bo)((0,n.Lk)("input",{type:"email",id:"email","onUpdate:modelValue":t[1]||(t[1]=e=>l.email=e),required:""},null,512),[[a.Jo,l.email]]),(0,n.Lk)("button",{type:"button",onClick:t[2]||(t[2]=(...e)=>r.getVerificationCode&&r.getVerificationCode(...e))},"獲取驗證碼"),(0,n.Lk)("div",{id:"verification-feedback",class:(0,i.C4)({feedback:!0,success:l.feedbackSuccess,error:!l.feedbackSuccess})},(0,i.v_)(l.verificationFeedback),3),ce,(0,n.bo)((0,n.Lk)("input",{type:"text",id:"verification_code","onUpdate:modelValue":t[3]||(t[3]=e=>l.verificationCode=e),required:""},null,512),[[a.Jo,l.verificationCode]]),ue,(0,n.Lk)("div",pe,[(0,n.bo)((0,n.Lk)("input",{type:"password",id:"password","onUpdate:modelValue":t[4]||(t[4]=e=>l.password=e),required:""},null,512),[[a.Jo,l.password]]),(0,n.Lk)("span",{class:"toggle-password",onClick:t[5]||(t[5]=(...e)=>r.handleTogglePassword&&r.handleTogglePassword(...e))},"👁️")]),me,he,(0,n.Lk)("div",ke,[(0,n.bo)((0,n.Lk)("input",{type:"password",id:"confirm_password","onUpdate:modelValue":t[6]||(t[6]=e=>l.confirmPassword=e),required:""},null,512),[[a.Jo,l.confirmPassword]]),(0,n.Lk)("span",{class:"toggle-password",onClick:t[7]||(t[7]=(...e)=>r.handleTogglePassword&&r.handleTogglePassword(...e))},"👁️")]),be,(0,n.bo)((0,n.Lk)("input",{type:"text",id:"phone","onUpdate:modelValue":t[8]||(t[8]=e=>l.phone=e),required:""},null,512),[[a.Jo,l.phone]]),fe],32)])])}var Le={data(){return{username:"",email:"",password:"",confirmPassword:"",phone:"",verificationCode:"",verificationFeedback:"",feedbackSuccess:!1,csrfToken:""}},methods:{setAxiosCsrfToken(e){ee.A.defaults.headers.common["X-CSRFToken"]=e},async fetchCsrfToken(){try{const e=await ee.A.get("http://127.0.0.1:8000/frontend/register/",{withCredentials:!0});this.csrfToken=e.data.csrfToken,this.setAxiosCsrfToken(this.csrfToken)}catch(e){console.error("Failed to fetch CSRF Token:",e)}},async getVerificationCode(){if(this.validateEmail(this.email))try{const e=await ee.A.post("http://127.0.0.1:8000/frontend/send-verification-code/",{email:this.email},{headers:{"X-CSRFToken":this.csrfToken},withCredentials:!0});this.feedbackSuccess=e.data.success,this.verificationFeedback=e.data.success?"驗證碼已發送到您的電子郵件，有效期限5分鐘。":e.data.message||"無法發送驗證碼，請稍後再試。"}catch(e){this.feedbackSuccess=!1,this.verificationFeedback="無法發送驗證碼，請稍後再試。"}else alert("請輸入有效的電子郵件地址。")},validateEmail(e){const t=/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/;return t.test(String(e).toLowerCase())},validatePassword(e){const t=/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/;return t.test(e)},handleTogglePassword(e){const t=e.target.previousElementSibling;t.type="password"===t.type?"text":"password"},async handleSubmit(){if(this.password===this.confirmPassword)if(this.validatePassword(this.password))try{const e=await ee.A.post("http://127.0.0.1:8000/frontend/register/",{username:this.username,email:this.email,password:this.password,confirmPassword:this.confirmPassword,phone:this.phone,verificationCode:this.verificationCode},{headers:{"X-CSRFToken":this.csrfToken},withCredentials:!0});e.data.success?(alert("註冊成功！"),this.$router.push("/frontend/home")):alert(e.data.message||"註冊失敗，請重試。")}catch(e){alert("註冊失敗，請稍後再試。")}else alert("密碼必須包含至少8個字符，且包括大小寫字母、數字和特殊字符。例如：Password@123");else alert("密碼與確認密碼不匹配。")}},created(){this.fetchCsrfToken()}};const ge=(0,h.A)(Le,[["render",ve],["__scopeId","data-v-20fb3f5e"]]);var Ce=ge;const ye=e=>((0,n.Qi)("data-v-4bb8df9a"),e=e(),(0,n.jt)(),e),we={class:"container"},_e=ye((()=>(0,n.Lk)("h2",null,"忘記密碼",-1))),Me=ye((()=>(0,n.Lk)("label",{for:"email"},"電子郵件：",-1))),Pe=ye((()=>(0,n.Lk)("button",{type:"submit"},"發送",-1)));function Ee(e,t,o,s,l,i){return(0,n.uX)(),(0,n.CE)("div",we,[_e,(0,n.Lk)("form",{onSubmit:t[1]||(t[1]=(0,a.D$)(((...e)=>i.sendPasswordReset&&i.sendPasswordReset(...e)),["prevent"]))},[Me,(0,n.bo)((0,n.Lk)("input",{type:"email",id:"email","onUpdate:modelValue":t[0]||(t[0]=e=>l.email=e),required:""},null,512),[[a.Jo,l.email]]),Pe],32)])}var Re={name:"ForgetPasswordPage",data(){return{email:"",csrfToken:""}},methods:{setAxiosCsrfToken(e){ee.A.defaults.headers.common["X-CSRFToken"]=e},async fetchCsrfToken(){try{const e=await ee.A.get("http://127.0.0.1:8000/frontend/forgot-password/",{withCredentials:!0});this.csrfToken=e.data.csrfToken,this.setAxiosCsrfToken(this.csrfToken)}catch(e){console.error("Failed to fetch CSRF Token:",e)}},async sendPasswordReset(){if(this.email)try{const e=await ee.A.post("http://127.0.0.1:8000/frontend/forgot-password/",{email:this.email},{headers:{"X-CSRFToken":this.csrfToken},withCredentials:!0});e.data.success?(alert("已發送密碼重設請求至您的電子郵件"),this.$router.push("/frontend/reset_password")):alert(e.data.message||"操作失敗，請稍後再試。")}catch(e){alert("操作失敗，請稍後再試。")}else alert("請輸入有效的電子郵件地址")}},created(){this.fetchCsrfToken()}};const Se=(0,h.A)(Re,[["render",Ee],["__scopeId","data-v-4bb8df9a"]]);var Ue=Se;const Ae={class:"home-page"},Ve={class:"branch-selection"},xe=(0,n.Lk)("label",{for:"branch-select"},"選擇分店:",-1),Fe=["value"],Te={class:"chart-controls"},$e={class:"chart-container"};function Ie(e,t,o,s,l,r){const d=(0,n.g2)("TopNavbar");return(0,n.uX)(),(0,n.CE)("div",Ae,[(0,n.bF)(d,{onExport:e.exportChart},null,8,["onExport"]),(0,n.Lk)("div",Ve,[xe,(0,n.bo)((0,n.Lk)("select",{id:"branch-select","onUpdate:modelValue":t[0]||(t[0]=e=>l.selectedBranch=e),onChange:t[1]||(t[1]=(...e)=>r.onBranchChange&&r.onBranchChange(...e))},[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(l.branches,(e=>((0,n.uX)(),(0,n.CE)("option",{key:e.branch_id,value:e.branch_id},(0,i.v_)(e.branch_name),9,Fe)))),128))],544),[[a.u1,l.selectedBranch]])]),(0,n.Lk)("div",Te,[(0,n.Lk)("button",{onClick:t[2]||(t[2]=e=>r.setCurrentChart("RevenueChart"))},"營業額"),(0,n.Lk)("button",{onClick:t[3]||(t[3]=e=>r.setCurrentChart("SalesChart"))},"銷售額"),(0,n.Lk)("button",{onClick:t[4]||(t[4]=e=>r.setCurrentChart("InventoryChart"))},"庫存量")]),(0,n.Lk)("div",$e,[((0,n.uX)(),(0,n.Wv)((0,n.$y)(l.currentChart),{"branch-id":l.selectedBranch},null,8,["branch-id"]))])])}const Xe={ref:"chartCanvas"};function qe(e,t,o,a,s,l){return(0,n.uX)(),(0,n.CE)("div",null,[(0,n.Lk)("canvas",Xe,null,512)])}var Be=o(6912);Be.t1.register(Be.hE,Be.m_,Be.s$,Be.ZT,Be.No,Be.FN,Be.kc,Be.PP);var De={name:"SalesChart",data(){return{chartData:{labels:["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"],datasets:[{label:"Sales",backgroundColor:"#f87979",data:[40,20,12,39,10,40,39,80,40,39,80,40]}]}}},mounted(){this.renderChart()},methods:{renderChart(){const e=this.$refs.chartCanvas.getContext("2d");new Be.t1(e,{type:"line",data:this.chartData,options:{responsive:!0,maintainAspectRatio:!1}})}}};const Je=(0,h.A)(De,[["render",qe],["__scopeId","data-v-ba34ad74"]]);var Ne=Je;const We={ref:"chartCanvas"};function je(e,t,o,a,s,l){return(0,n.uX)(),(0,n.CE)("div",null,[(0,n.Lk)("canvas",We,null,512)])}Be.t1.register(Be.hE,Be.m_,Be.s$,Be.ZT,Be.No,Be.FN,Be.kc,Be.PP);var Qe={name:"RevenueChart",data(){return{chartData:{labels:["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"],datasets:[{label:"Revenue",backgroundColor:"#f87979",data:[30,10,5,25,15,30,25,60,30,25,60,30]}]}}},mounted(){this.renderChart()},methods:{renderChart(){const e=this.$refs.chartCanvas.getContext("2d");new Be.t1(e,{type:"line",data:this.chartData,options:{responsive:!0,maintainAspectRatio:!1}})}}};const ze=(0,h.A)(Qe,[["render",je],["__scopeId","data-v-45aaeee3"]]);var Oe=ze;const He={ref:"chartCanvas"};function Ke(e,t,o,a,s,l){return(0,n.uX)(),(0,n.CE)("div",null,[(0,n.Lk)("canvas",He,null,512)])}Be.t1.register(Be.hE,Be.m_,Be.s$,Be.ZT,Be.No,Be.FN,Be.kc,Be.PP);var Ze={name:"InventoryChart",data(){return{chartData:{labels:["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"],datasets:[{label:"Inventory",backgroundColor:"#f87979",data:[50,25,18,45,20,50,45,100,50,45,100,50]}]}}},mounted(){this.renderChart()},methods:{renderChart(){const e=this.$refs.chartCanvas.getContext("2d");new Be.t1(e,{type:"line",data:this.chartData,options:{responsive:!0,maintainAspectRatio:!1}})}}};const Ge=(0,h.A)(Ze,[["render",Ke],["__scopeId","data-v-5a935ee6"]]);var Ye=Ge,et={name:"HomePage",components:{TopNavbar:b,SalesChart:Ne,RevenueChart:Oe,InventoryChart:Ye},data(){return{currentChart:"SalesChart",branches:[],selectedBranch:null}},methods:{async fetchBranches(){try{const e=await ee.A.get("http://127.0.0.1:8000/api/branches/");this.branches=e.data,this.selectedBranch=this.branches.length>0?this.branches[0].branch_id:null}catch(e){console.error("Error fetching branches:",e)}},setCurrentChart(e){this.currentChart=e},onBranchChange(){console.log("Selected branch:",this.selectedBranch)}},async mounted(){await this.fetchBranches()}};const tt=(0,h.A)(et,[["render",Ie]]);var ot=tt;const at=e=>((0,n.Qi)("data-v-4da14fdb"),e=e(),(0,n.jt)(),e),nt={class:"info-container"},st=at((()=>(0,n.Lk)("h3",null,"個人資訊",-1))),lt={key:0},it={class:"button-container"},rt={key:1},dt={class:"button-container"};function ct(e,t,o,s,l,r){return(0,n.uX)(),(0,n.CE)("div",null,[(0,n.Lk)("div",{class:(0,i.C4)(["content",{shift:l.isSidebarOpen}]),id:"content"},[(0,n.Lk)("div",nt,[st,l.isEditing?((0,n.uX)(),(0,n.CE)("div",rt,[(0,n.Lk)("p",null,[(0,n.eW)("帳號："),(0,n.bo)((0,n.Lk)("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=e=>l.editData.username=e)},null,512),[[a.Jo,l.editData.username]])]),(0,n.Lk)("p",null,[(0,n.eW)("部門："),(0,n.bo)((0,n.Lk)("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=e=>l.editData.department_id=e)},null,512),[[a.Jo,l.editData.department_id]])]),(0,n.Lk)("p",null,[(0,n.eW)("職位："),(0,n.bo)((0,n.Lk)("input",{type:"text","onUpdate:modelValue":t[3]||(t[3]=e=>l.editData.position_id=e)},null,512),[[a.Jo,l.editData.position_id]])]),(0,n.Lk)("p",null,[(0,n.eW)("電話："),(0,n.bo)((0,n.Lk)("input",{type:"text","onUpdate:modelValue":t[4]||(t[4]=e=>l.editData.phone=e)},null,512),[[a.Jo,l.editData.phone]])]),(0,n.Lk)("p",null,[(0,n.eW)("電子郵件："),(0,n.bo)((0,n.Lk)("input",{type:"email","onUpdate:modelValue":t[5]||(t[5]=e=>l.editData.email=e)},null,512),[[a.Jo,l.editData.email]])]),(0,n.Lk)("div",dt,[(0,n.Lk)("button",{class:"save",onClick:t[6]||(t[6]=(...e)=>r.saveProfile&&r.saveProfile(...e))},"保存"),(0,n.Lk)("button",{class:"cancel",onClick:t[7]||(t[7]=(...e)=>r.cancelEdit&&r.cancelEdit(...e))},"取消")])])):((0,n.uX)(),(0,n.CE)("div",lt,[(0,n.Lk)("p",null,[(0,n.eW)("帳號："),(0,n.Lk)("span",null,(0,i.v_)(l.userData.username||"N/A"),1)]),(0,n.Lk)("p",null,[(0,n.eW)("部門："),(0,n.Lk)("span",null,(0,i.v_)(l.userData.department_id||"N/A"),1)]),(0,n.Lk)("p",null,[(0,n.eW)("職位："),(0,n.Lk)("span",null,(0,i.v_)(l.userData.position_id||"N/A"),1)]),(0,n.Lk)("p",null,[(0,n.eW)("電話："),(0,n.Lk)("span",null,(0,i.v_)(l.userData.phone||"N/A"),1)]),(0,n.Lk)("p",null,[(0,n.eW)("電子郵件："),(0,n.Lk)("span",null,(0,i.v_)(l.userData.email||"N/A"),1)]),(0,n.Lk)("div",it,[(0,n.Lk)("button",{class:"edit",onClick:t[0]||(t[0]=(...e)=>r.editProfile&&r.editProfile(...e))},"編輯")])]))])],2)])}var ut={data(){return{userData:{username:"",email:"",phone:"",department_name:"",position_name:""},editData:{},isSidebarOpen:!1,isEditing:!1}},methods:{toggleSidebar(){this.isSidebarOpen=!this.isSidebarOpen},async fetchUserProfile(){try{const e=await ee.A.get("/api/frontend/profile/");this.userData=e.data}catch(e){console.error("Error fetching user profile:",e)}},editProfile(){this.editData={...this.userData},this.isEditing=!0},cancelEdit(){this.isEditing=!1},async saveProfile(){try{await ee.A.put("/api/frontend/profile/",this.editData),this.userData={...this.editData},this.isEditing=!1,alert("個人信息已更新")}catch(e){console.error("Error saving profile:",e),alert("保存失敗")}}},mounted(){this.fetchUserProfile()}};const pt=(0,h.A)(ut,[["render",ct],["__scopeId","data-v-4da14fdb"]]);var mt=pt;const ht={class:"account-settings-page"},kt={class:"main-panel"},bt={class:"container"},ft={class:"account-settings"},vt=(0,n.Lk)("img",{class:"profile-pic",src:"https://via.placeholder.com/100",alt:"Profile Picture"},null,-1),Lt=(0,n.Lk)("h3",null,"wang",-1),gt=(0,n.Lk)("img",{src:"https://img.icons8.com/ios-filled/50/000000/lock.png",alt:"修改密碼"},null,-1),Ct=(0,n.Lk)("img",{src:"https://img.icons8.com/ios-filled/50/000000/settings.png",alt:"偏好設定"},null,-1);function yt(e,t,o,a,s,l){const i=(0,n.g2)("router-link");return(0,n.uX)(),(0,n.CE)("div",ht,[(0,n.Lk)("div",kt,[(0,n.Lk)("div",bt,[(0,n.Lk)("div",ft,[vt,Lt,(0,n.bF)(i,{to:"/frontend/changepassword",class:"setting-option"},{default:(0,n.k6)((()=>[gt,(0,n.eW)(" 修改密碼 ")])),_:1}),(0,n.bF)(i,{to:"/frontend/preferences",class:"setting-option"},{default:(0,n.k6)((()=>[Ct,(0,n.eW)(" 偏好設定 ")])),_:1})])])])])}var wt={name:"AccountSettings"};const _t=(0,h.A)(wt,[["render",yt]]);var Mt=_t;const Pt=e=>((0,n.Qi)("data-v-495d8860"),e=e(),(0,n.jt)(),e),Et={class:"change-password-container"},Rt=Pt((()=>(0,n.Lk)("h2",null,"修改密碼",-1))),St={class:"input-group"},Ut=Pt((()=>(0,n.Lk)("label",{for:"currentPassword"},"原密碼",-1))),At={class:"input-group"},Vt=Pt((()=>(0,n.Lk)("label",{for:"newPassword"},"新密碼",-1))),xt={class:"input-group"},Ft=Pt((()=>(0,n.Lk)("label",{for:"confirmNewPassword"},"確認新密碼",-1))),Tt=Pt((()=>(0,n.Lk)("button",{type:"submit",class:"submit-button"},"更改密碼",-1))),$t={id:"feedback",class:"feedback"};function It(e,t,o,s,l,r){return(0,n.uX)(),(0,n.CE)("div",Et,[Rt,(0,n.Lk)("form",{onSubmit:t[4]||(t[4]=(0,a.D$)(((...e)=>r.handleChangePassword&&r.handleChangePassword(...e)),["prevent"]))},[(0,n.Lk)("div",St,[Ut,(0,n.bo)((0,n.Lk)("input",{type:"password",id:"currentPassword","onUpdate:modelValue":t[0]||(t[0]=e=>l.currentPassword=e),required:""},null,512),[[a.Jo,l.currentPassword]])]),(0,n.Lk)("div",At,[Vt,(0,n.bo)((0,n.Lk)("input",{type:"password",id:"newPassword","onUpdate:modelValue":t[1]||(t[1]=e=>l.newPassword=e),required:""},null,512),[[a.Jo,l.newPassword]])]),(0,n.Lk)("div",xt,[Ft,(0,n.bo)((0,n.Lk)("input",{type:"password",id:"confirmNewPassword","onUpdate:modelValue":t[2]||(t[2]=e=>l.confirmNewPassword=e),required:""},null,512),[[a.Jo,l.confirmNewPassword]])]),Tt,(0,n.Lk)("button",{type:"button",class:"cancel-button",onClick:t[3]||(t[3]=(...e)=>r.cancelChanges&&r.cancelChanges(...e))},"取消變更"),(0,n.Lk)("div",$t,(0,i.v_)(l.feedback),1)],32)])}var Xt={data(){return{currentPassword:"",newPassword:"",confirmNewPassword:"",feedback:""}},methods:{handleChangePassword(){this.newPassword!==this.confirmNewPassword?this.feedback="新密碼與確認密碼不匹配":this.feedback="密碼已更改"},cancelChanges(){this.feedback="您取消了變更密碼"}}};const qt=(0,h.A)(Xt,[["render",It],["__scopeId","data-v-495d8860"]]);var Bt=qt;const Dt=(0,n.Lk)("div",null,null,-1),Jt=(0,n.Lk)("div",null,null,-1),Nt=(0,n.Lk)("div",null,null,-1),Wt=[Dt,Jt,Nt],jt={class:"content",id:"content"},Qt={class:"container"},zt={class:"preferences"},Ot=(0,n.Lk)("div",{class:"header"},"偏好設定",-1),Ht={class:"form-group"},Kt=(0,n.Lk)("label",{for:"font-size"},"字體大小",-1),Zt=(0,n.Lk)("option",{value:"large"},"大",-1),Gt=(0,n.Lk)("option",{value:"medium"},"適中",-1),Yt=(0,n.Lk)("option",{value:"small"},"小",-1),eo=[Zt,Gt,Yt],to={class:"form-group"},oo=(0,n.Lk)("label",{for:"notification"},"通知設定",-1),ao=(0,n.Lk)("option",{value:"enable"},"開啟通知",-1),no=(0,n.Lk)("option",{value:"disable"},"關閉通知",-1),so=[ao,no],lo={class:"form-group"},io=(0,n.Lk)("label",{for:"auto-login"},"自動登入",-1),ro=(0,n.Lk)("option",{value:"enable"},"自動登入",-1),co=(0,n.Lk)("option",{value:"disable"},"取消自動登入",-1),uo=[ro,co],po={class:"form-group"},mo=(0,n.Lk)("label",{for:"authentication"},"認證設定",-1),ho=(0,n.Lk)("option",{value:"enable"},"開啟認證",-1),ko=(0,n.Lk)("option",{value:"disable"},"關閉認證",-1),bo=[ho,ko],fo={class:"buttons"};function vo(e,t,o,s,l,i){return(0,n.uX)(),(0,n.CE)("div",null,[(0,n.Lk)("button",{class:"hamburger-menu",onClick:t[0]||(t[0]=(...e)=>i.toggleMenu&&i.toggleMenu(...e))},Wt),(0,n.Lk)("div",jt,[(0,n.Lk)("div",Qt,[(0,n.Lk)("div",zt,[Ot,(0,n.Lk)("div",Ht,[Kt,(0,n.bo)((0,n.Lk)("select",{id:"font-size","onUpdate:modelValue":t[1]||(t[1]=e=>l.fontSize=e)},eo,512),[[a.u1,l.fontSize]])]),(0,n.Lk)("div",to,[oo,(0,n.bo)((0,n.Lk)("select",{id:"notification","onUpdate:modelValue":t[2]||(t[2]=e=>l.notification=e)},so,512),[[a.u1,l.notification]])]),(0,n.Lk)("div",lo,[io,(0,n.bo)((0,n.Lk)("select",{id:"auto-login","onUpdate:modelValue":t[3]||(t[3]=e=>l.autoLogin=e)},uo,512),[[a.u1,l.autoLogin]])]),(0,n.Lk)("div",po,[mo,(0,n.bo)((0,n.Lk)("select",{id:"authentication","onUpdate:modelValue":t[4]||(t[4]=e=>l.authentication=e)},bo,512),[[a.u1,l.authentication]])]),(0,n.Lk)("div",fo,[(0,n.Lk)("button",{class:"cancel-button",onClick:t[5]||(t[5]=(...e)=>i.cancelChanges&&i.cancelChanges(...e))},"取消變更"),(0,n.Lk)("button",{class:"submit-button",onClick:t[6]||(t[6]=(...e)=>i.submitChanges&&i.submitChanges(...e))},"更改")])])])])])}var Lo={name:"PreferenceSetting",data(){return{fontSize:"medium",notification:"disable",autoLogin:"disable",authentication:"disable"}},methods:{toggleMenu(){const e=document.querySelector(".dropdown-content");e.style.display="block"===e.style.display?"none":"block"},cancelChanges(){this.fontSize="medium",this.notification="disable",this.autoLogin="disable",this.authentication="disable"},submitChanges(){const e="large"===this.fontSize?"18px":"small"===this.fontSize?"12px":"16px";document.body.style.fontSize=e,alert("偏好設定已更改")}}};const go=(0,h.A)(Lo,[["render",vo]]);var Co=go;const yo=e=>((0,n.Qi)("data-v-d60bb562"),e=e(),(0,n.jt)(),e),wo={class:"history-page"},_o={class:"container"},Mo={key:0,class:"no-history centered-content"},Po=yo((()=>(0,n.Lk)("p",null,"未登入，無紀錄顯示。",-1))),Eo=[Po],Ro={key:1},So={class:"search-container centered-content"},Uo={class:"timeline centered-content",id:"timeline"},Ao=["onClick"],Vo={class:"timeline-panel"},xo={class:"timeline-heading"},Fo={class:"timeline-body"},To={class:"timeline-user"},$o={class:"timeline",id:"timeline"},Io=["onClick"],Xo={class:"timeline-panel"},qo={class:"timeline-heading"},Bo={class:"timeline-body"},Do={class:"timeline-user"};function Jo(e,t,o,s,l,r){const d=(0,n.g2)("SidebarPage");return(0,n.uX)(),(0,n.CE)("div",null,[(0,n.bF)(d),(0,n.Lk)("div",wo,[(0,n.Lk)("div",_o,[l.isLoggedIn?((0,n.uX)(),(0,n.CE)("div",Ro,[(0,n.Lk)("div",So,[(0,n.bo)((0,n.Lk)("input",{type:"text",id:"searchInput",placeholder:"搜尋紀錄...","onUpdate:modelValue":t[0]||(t[0]=e=>l.searchQuery=e)},null,512),[[a.Jo,l.searchQuery]]),(0,n.Lk)("button",{onClick:t[1]||(t[1]=(...e)=>r.filterTimeline&&r.filterTimeline(...e))},"搜尋")]),(0,n.Lk)("ul",Uo,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(r.filteredItems,(e=>((0,n.uX)(),(0,n.CE)("li",{class:"timeline-item",key:e.id,onClick:t=>r.showDetail(e.id)},[(0,n.Lk)("div",Vo,[(0,n.Lk)("div",xo,[(0,n.Lk)("h4",null,(0,i.v_)(e.date),1)]),(0,n.Lk)("div",Fo,[(0,n.Lk)("p",null,(0,i.v_)(e.action),1),(0,n.Lk)("div",To,"使用者: "+(0,i.v_)(e.user),1)])])],8,Ao)))),128))])])):((0,n.uX)(),(0,n.CE)("div",Mo,Eo))]),(0,n.Lk)("ul",$o,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(r.filteredItems,(e=>((0,n.uX)(),(0,n.CE)("li",{class:"timeline-item",key:e.id,onClick:t=>r.showDetail(e.id)},[(0,n.Lk)("div",Xo,[(0,n.Lk)("div",qo,[(0,n.Lk)("h4",null,(0,i.v_)(e.date),1)]),(0,n.Lk)("div",Bo,[(0,n.Lk)("p",null,(0,i.v_)(e.action),1),(0,n.Lk)("div",Do,"使用者: "+(0,i.v_)(e.user),1)])])],8,Io)))),128))])])])}function No(e){let t=null;if(document.cookie&&""!==document.cookie){const o=document.cookie.split(";");for(let a=0;a<o.length;a++){const n=o[a].trim();if(n.substring(0,e.length+1)===e+"="){t=decodeURIComponent(n.substring(e.length+1));break}}}return t}ee.A.defaults.baseURL="http://localhost:8000",ee.A.defaults.withCredentials=!0,ee.A.interceptors.request.use((e=>{const t=localStorage.getItem("token");t&&(e.headers["Authorization"]=`Bearer ${t}`);const o=No("csrftoken");return o&&(e.headers["X-CSRFToken"]=o),e}),(e=>Promise.reject(e)));var Wo=ee.A,jo={name:"HistoryPage",components:{SidebarPage:R},data(){return{searchQuery:"",items:[],isLoggedIn:!1}},computed:{filteredItems(){return this.items.filter((e=>{const t=this.searchQuery.trim().toUpperCase();return e.action.toUpperCase().includes(t)||e.date.includes(t)}))}},methods:{filterTimeline(){},showDetail(e){this.$router.push(`/detail/${e}`)},async checkLoginStatus(){try{const e=await Wo.get("/api/frontend/check_login_status");this.isLoggedIn=e.data.loggedIn,this.isLoggedIn?this.fetchHistory():this.$router.pugh("/login")}catch(e){console.error("無法檢查登入狀態:",e)}},async fetchHistory(){try{const e=await Wo.get("/api/frontend/history/");this.items=e.data}catch(e){console.error("無法獲取歷史記錄:",e)}}},mounted(){this.checkLoginStatus()}};const Qo=(0,h.A)(jo,[["render",Jo],["__scopeId","data-v-d60bb562"]]);var zo=Qo;const Oo=e=>((0,n.Qi)("data-v-24b9cf2e"),e=e(),(0,n.jt)(),e),Ho={class:"history-details"},Ko={class:"container"},Zo={key:0,class:"details-container"},Go={class:"details-content"},Yo={key:0},ea={key:1},ta={key:1},oa=Oo((()=>(0,n.Lk)("p",null,"未找到該紀錄的詳細信息。",-1))),aa=[oa],na={class:"back-btn"};function sa(e,t,o,a,s,l){return(0,n.uX)(),(0,n.CE)("div",Ho,[(0,n.Lk)("div",Ko,[s.detail?((0,n.uX)(),(0,n.CE)("div",Zo,[(0,n.Lk)("h2",null,(0,i.v_)(s.detail.timestamp),1),(0,n.Lk)("div",Go,[(0,n.Lk)("p",null,"操作："+(0,i.v_)(s.detail.action),1),(0,n.Lk)("p",null,"時間："+(0,i.v_)(s.detail.timestamp),1),(0,n.Lk)("p",null,"使用者："+(0,i.v_)(s.detail.user),1),s.detail.device?((0,n.uX)(),(0,n.CE)("p",Yo,"設備品牌："+(0,i.v_)(s.detail.device.brand),1)):(0,n.Q3)("",!0),s.detail.device?((0,n.uX)(),(0,n.CE)("p",ea,"設備類型："+(0,i.v_)(s.detail.device.type),1)):(0,n.Q3)("",!0),(0,n.Lk)("p",null,"操作結果："+(0,i.v_)(s.detail.success?"成功":"失敗"),1)])])):((0,n.uX)(),(0,n.CE)("div",ta,aa)),(0,n.Lk)("div",na,[(0,n.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>l.goBack&&l.goBack(...e))},"返回上一頁")])])])}var la={data(){return{details:[{id:1,timestamp:"2024/1/22 16:22:39",action:"編輯個人資訊",user:"User1",device:{brand:"Dell",type:"PC"},success:!0},{id:2,timestamp:"2024/1/22 16:00:21",action:"查看首頁",user:"User2",device:{brand:"Apple",type:"平板"},success:!1},{id:3,timestamp:"2024/7/12 22:03",action:"登入",user:"User3",device:{brand:"Samsung",type:"手機"},success:!0}],detail:null}},mounted(){const e=parseInt(this.$route.params.id);this.detail=this.details.find((t=>t.id===e))||{error:"未找到該紀錄的詳細信息。"}},methods:{goBack(){this.$router.go(-1)}}};const ia=(0,h.A)(la,[["render",sa],["__scopeId","data-v-24b9cf2e"]]);var ra=ia;const da=e=>((0,n.Qi)("data-v-8fd722f4"),e=e(),(0,n.jt)(),e),ca={class:"container"},ua=da((()=>(0,n.Lk)("h2",null,"重設密碼",-1))),pa={class:"input-container"},ma=da((()=>(0,n.Lk)("label",{for:"resetCode"},"重置代碼：",-1))),ha={class:"input-container"},ka=da((()=>(0,n.Lk)("label",{for:"newPassword"},"新密碼：",-1))),ba={class:"password-container"},fa={key:0,class:"error"},va={class:"input-container"},La=da((()=>(0,n.Lk)("label",{for:"confirmPassword"},"確認新密碼：",-1))),ga={class:"password-container"},Ca={key:0,class:"error"},ya=da((()=>(0,n.Lk)("button",{type:"submit"},"重設密碼",-1)));function wa(e,t,o,s,l,r){return(0,n.uX)(),(0,n.CE)("div",ca,[ua,(0,n.Lk)("form",{onSubmit:t[5]||(t[5]=(0,a.D$)(((...e)=>r.handleResetPassword&&r.handleResetPassword(...e)),["prevent"]))},[(0,n.Lk)("div",pa,[ma,(0,n.bo)((0,n.Lk)("input",{type:"text",id:"resetCode","onUpdate:modelValue":t[0]||(t[0]=e=>l.resetCode=e),required:""},null,512),[[a.Jo,l.resetCode]])]),(0,n.Lk)("div",ha,[ka,(0,n.Lk)("div",ba,[(0,n.bo)((0,n.Lk)("input",{type:"password",id:"newPassword","onUpdate:modelValue":t[1]||(t[1]=e=>l.newPassword=e),required:""},null,512),[[a.Jo,l.newPassword]]),(0,n.Lk)("span",{class:"toggle-password",onClick:t[2]||(t[2]=(...e)=>r.handleTogglePassword&&r.handleTogglePassword(...e))},"👁️")]),l.passwordError?((0,n.uX)(),(0,n.CE)("p",fa,(0,i.v_)(l.passwordError),1)):(0,n.Q3)("",!0)]),(0,n.Lk)("div",va,[La,(0,n.Lk)("div",ga,[(0,n.bo)((0,n.Lk)("input",{type:"password",id:"confirmPassword","onUpdate:modelValue":t[3]||(t[3]=e=>l.confirmPassword=e),required:""},null,512),[[a.Jo,l.confirmPassword]]),(0,n.Lk)("span",{class:"toggle-password",onClick:t[4]||(t[4]=(...e)=>r.handleTogglePassword&&r.handleTogglePassword(...e))},"👁️")]),l.confirmPasswordError?((0,n.uX)(),(0,n.CE)("p",Ca,(0,i.v_)(l.confirmPasswordError),1)):(0,n.Q3)("",!0)]),ya],32)])}var _a={name:"ResetPasswordPage",data(){return{resetCode:"",newPassword:"",confirmPassword:"",csrfToken:"",passwordError:"",confirmPasswordError:""}},methods:{setAxiosCsrfToken(e){ee.A.defaults.headers.common["X-CSRFToken"]=e},async fetchCsrfToken(){try{const e=await ee.A.get("http://127.0.0.1:8000/frontend/reset-password/",{withCredentials:!0});this.csrfToken=e.data.csrfToken,this.setAxiosCsrfToken(this.csrfToken)}catch(e){console.error("Failed to fetch CSRF Token:",e)}},validatePasswordStrength(e){const t=8,o=/[A-Z]/.test(e),a=/[a-z]/.test(e),n=/\d/.test(e),s=/[!@#$%^&*(),.?":{}|<>]/.test(e);return e.length>=t&&o&&a&&n&&s},async handleResetPassword(){if(this.passwordError="",this.confirmPasswordError="",this.validatePasswordStrength(this.newPassword))if(this.newPassword===this.confirmPassword)try{const e=await ee.A.post("http://127.0.0.1:8000/frontend/reset-password/",{resetCode:this.resetCode,newPassword:this.newPassword},{headers:{"X-CSRFToken":this.csrfToken},withCredentials:!0});e.data.success?(alert("密碼重置成功！"),this.$router.push("/frontend/login")):alert(e.data.message||"重置失敗，請稍後再試。")}catch(e){alert("重置失敗，請稍後再試。")}else this.confirmPasswordError="新密碼和確認新密碼不匹配";else this.passwordError="密碼必須至少包含8個字符，且包括大小寫字母、數字和特殊字符"},handleTogglePassword(e){const t=e.target.previousElementSibling;t.type="password"===t.type?"text":"password"}},created(){this.fetchCsrfToken()}};const Ma=(0,h.A)(_a,[["render",wa],["__scopeId","data-v-8fd722f4"]]);var Pa=Ma;const Ea=e=>((0,n.Qi)("data-v-2c241186"),e=e(),(0,n.jt)(),e),Ra={class:"container"},Sa=Ea((()=>(0,n.Lk)("h2",null,"登入",-1))),Ua=Ea((()=>(0,n.Lk)("input",{type:"hidden",name:"next",value:"/backend/management"},null,-1))),Aa={class:"form-group"},Va=Ea((()=>(0,n.Lk)("label",{for:"email"},"帳號:",-1))),xa={class:"form-group"},Fa=Ea((()=>(0,n.Lk)("label",{for:"password"},"密碼:",-1))),Ta={class:"form-group"},$a=Ea((()=>(0,n.Lk)("label",{for:"remember_me"},"記住我",-1))),Ia=Ea((()=>(0,n.Lk)("button",{type:"submit",class:"btn-login"},"登入",-1))),Xa={key:0};function qa(e,t,o,s,l,r){const d=(0,n.g2)("router-link");return(0,n.uX)(),(0,n.CE)("div",Ra,[Sa,(0,n.Lk)("form",{onSubmit:t[3]||(t[3]=(0,a.D$)(((...e)=>r.login&&r.login(...e)),["prevent"]))},[Ua,(0,n.Lk)("div",Aa,[Va,(0,n.bo)((0,n.Lk)("input",{type:"email",id:"email","onUpdate:modelValue":t[0]||(t[0]=e=>l.email=e),required:""},null,512),[[a.Jo,l.email]])]),(0,n.Lk)("div",xa,[Fa,(0,n.bo)((0,n.Lk)("input",{type:"password",id:"password","onUpdate:modelValue":t[1]||(t[1]=e=>l.password=e),required:""},null,512),[[a.Jo,l.password]])]),(0,n.Lk)("div",Ta,[(0,n.bo)((0,n.Lk)("input",{type:"checkbox",id:"remember_me","onUpdate:modelValue":t[2]||(t[2]=e=>l.rememberMe=e)},null,512),[[a.lH,l.rememberMe]]),$a]),Ia],32),(0,n.Lk)("p",null,[(0,n.eW)(" 還未擁有帳號? "),(0,n.bF)(d,{to:"/frontend/register"},{default:(0,n.k6)((()=>[(0,n.eW)("註冊")])),_:1})]),(0,n.Lk)("p",null,[(0,n.eW)(" 忘記密碼? "),(0,n.bF)(d,{to:"/frontend/forgot_password"},{default:(0,n.k6)((()=>[(0,n.eW)("重置密碼")])),_:1})]),l.error?((0,n.uX)(),(0,n.CE)("p",Xa,(0,i.v_)(l.error),1)):(0,n.Q3)("",!0)])}var Ba={name:"AppLogin",data(){return{email:"",password:"",rememberMe:!1,error:""}},methods:{async login(){try{const e=Da("csrftoken"),t=await Wo.post("/api/token/",{email:this.email,password:this.password,remember_me:this.rememberMe},{headers:{"X-CSRFToken":e}});console.log("登入成功",t),localStorage.setItem("token",t.data.access),this.$router.push("/backend/management")}catch(e){console.error("登入失败",e.response),e.response&&e.response.data?this.error=e.response.data.detail||"登入失敗，請檢查您的使用者名稱和密碼":this.error="登入失敗，請稍後再試"}}}};function Da(e){let t=null;if(document.cookie&&""!==document.cookie){const o=document.cookie.split(";");for(let a=0;a<o.length;a++){const n=o[a].trim();if(n.substring(0,e.length+1)===e+"="){t=decodeURIComponent(n.substring(e.length+1));break}}}return t}const Ja=(0,h.A)(Ba,[["render",qa],["__scopeId","data-v-2c241186"]]);var Na=Ja;const Wa=e=>((0,n.Qi)("data-v-1058d71e"),e=e(),(0,n.jt)(),e),ja={class:"container"},Qa=Wa((()=>(0,n.Lk)("h2",null,"註冊",-1))),za={key:0,class:"error"},Oa=Wa((()=>(0,n.Lk)("label",{for:"username"},"用戶名:",-1))),Ha=Wa((()=>(0,n.Lk)("label",{for:"email"},"電子郵件:",-1))),Ka={id:"verification-feedback",class:"feedback"},Za=Wa((()=>(0,n.Lk)("label",{for:"verification_code"},"驗證碼:",-1))),Ga={id:"verification-feedback",class:"feedback"},Ya=Wa((()=>(0,n.Lk)("label",{for:"password"},"密碼:",-1))),en=Wa((()=>(0,n.Lk)("label",{for:"confirm_password"},"確認密碼:",-1))),tn=Wa((()=>(0,n.Lk)("label",{for:"phone"},"手機號碼:",-1))),on=Wa((()=>(0,n.Lk)("input",{type:"submit",value:"註冊"},null,-1))),an=Wa((()=>(0,n.Lk)("p",{class:"terms"},[(0,n.eW)(" 點擊「註冊」表示您同意我們的 "),(0,n.Lk)("a",{href:"#"},"服務條款"),(0,n.eW)(" 和 "),(0,n.Lk)("a",{href:"#"},"隱私政策")],-1)));function nn(e,t,o,s,l,r){return(0,n.uX)(),(0,n.CE)("div",ja,[Qa,(0,n.Lk)("form",{onSubmit:t[8]||(t[8]=(0,a.D$)(((...e)=>r.register&&r.register(...e)),["prevent"]))},[l.error?((0,n.uX)(),(0,n.CE)("div",za,[(0,n.Lk)("p",null,(0,i.v_)(l.error),1)])):(0,n.Q3)("",!0),Oa,(0,n.bo)((0,n.Lk)("input",{type:"text",id:"username","onUpdate:modelValue":t[0]||(t[0]=e=>l.form.username=e),required:""},null,512),[[a.Jo,l.form.username]]),Ha,(0,n.bo)((0,n.Lk)("input",{type:"email",id:"email","onUpdate:modelValue":t[1]||(t[1]=e=>l.form.email=e),required:""},null,512),[[a.Jo,l.form.email]]),(0,n.Lk)("button",{type:"button",onClick:t[2]||(t[2]=(...e)=>r.getVerificationCode&&r.getVerificationCode(...e))},"獲取驗證碼"),(0,n.Lk)("div",Ka,(0,i.v_)(l.feedback),1),Za,(0,n.bo)((0,n.Lk)("input",{type:"text",id:"verification_code","onUpdate:modelValue":t[3]||(t[3]=e=>l.form.verification_code=e),required:""},null,512),[[a.Jo,l.form.verification_code]]),(0,n.Lk)("button",{type:"button",onClick:t[4]||(t[4]=(...e)=>r.validateVerificationCode&&r.validateVerificationCode(...e))},"驗證碼驗證"),(0,n.Lk)("div",Ga,(0,i.v_)(l.feedback),1),Ya,(0,n.bo)((0,n.Lk)("input",{type:"password",id:"password","onUpdate:modelValue":t[5]||(t[5]=e=>l.form.password=e),required:""},null,512),[[a.Jo,l.form.password]]),en,(0,n.bo)((0,n.Lk)("input",{type:"password",id:"confirm_password","onUpdate:modelValue":t[6]||(t[6]=e=>l.form.confirm_password=e),required:""},null,512),[[a.Jo,l.form.confirm_password]]),tn,(0,n.bo)((0,n.Lk)("input",{type:"text",id:"phone","onUpdate:modelValue":t[7]||(t[7]=e=>l.form.phone=e),required:""},null,512),[[a.Jo,l.form.phone]]),on,an],32)])}var sn={name:"AppRegister",data(){return{form:{username:"",email:"",verification_code:"",password:"",confirm_password:"",phone:""},error:"",feedback:""}},methods:{getVerificationCode(){const e=this.form.email.trim();this.validateEmail(e)?Wo.get(`/backend/send_verification_code/?email=${encodeURIComponent(e)}`).then((e=>{e.data.success?(alert("驗證碼已發送到您的電子郵件。"),this.feedback="驗證碼已發送到您的電子郵件，有效期限5分鐘。"):(alert("發送驗證碼失敗。"),this.feedback="發送驗證碼失敗，請重試。")})).catch((()=>{alert("發送驗證碼失敗。"),this.feedback="發送驗證碼失敗，請重試。"})):alert("請輸入有效的電子郵件地址。")},validateVerificationCode(){const e=this.form.email.trim(),t=this.form.verification_code.trim();""!==t?Wo.get(`/backend/verify_code/?email=${encodeURIComponent(e)}&code=${encodeURIComponent(t)}`).then((e=>{e.data.success?(alert("驗證碼有效。"),this.feedback="驗證碼有效。"):(alert("驗證碼無效或已過期。"),this.feedback="驗證碼無效或已過期，請重試。")})).catch((()=>{alert("驗證碼驗證失敗。"),this.feedback="驗證碼驗證失敗，請重試。"})):alert("請輸入驗證碼。")},validateEmail(e){const t=/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/;return t.test(String(e).toLowerCase())},register(){console.log("Registering user:",this.form)}}};const ln=(0,h.A)(sn,[["render",nn],["__scopeId","data-v-1058d71e"]]);var rn=ln;const dn=e=>((0,n.Qi)("data-v-2d1476f6"),e=e(),(0,n.jt)(),e),cn={class:"container"},un=dn((()=>(0,n.Lk)("h2",null,"忘記密碼",-1))),pn=dn((()=>(0,n.Lk)("label",{for:"email"},"電子郵件：",-1))),mn=dn((()=>(0,n.Lk)("button",{type:"submit"},"發送",-1)));function hn(e,t,o,s,l,i){return(0,n.uX)(),(0,n.CE)("div",cn,[un,(0,n.Lk)("form",{onSubmit:t[1]||(t[1]=(0,a.D$)(((...e)=>i.sendPasswordReset&&i.sendPasswordReset(...e)),["prevent"]))},[pn,(0,n.bo)((0,n.Lk)("input",{type:"email",id:"email","onUpdate:modelValue":t[0]||(t[0]=e=>l.email=e),required:""},null,512),[[a.Jo,l.email]]),mn],32)])}var kn={name:"ForgetPasswordPage",data(){return{email:""}},methods:{sendPasswordReset(){this.email?alert("已發送密碼重設請求至您的電子郵件"):alert("請輸入有效的電子郵件地址")}}};const bn=(0,h.A)(kn,[["render",hn],["__scopeId","data-v-2d1476f6"]]);var fn=bn;const vn=e=>((0,n.Qi)("data-v-226d2503"),e=e(),(0,n.jt)(),e),Ln={key:0},gn=vn((()=>(0,n.Lk)("h1",{id:"welcome-title"},"歡迎來到管理介面",-1))),Cn=vn((()=>(0,n.Lk)("p",{id:"welcome-description"},"請選擇一個選項來管理。",-1))),yn=[gn,Cn];function wn(e,t,o,a,s,l){const r=(0,n.g2)("Sidebar"),d=(0,n.g2)("router-view");return(0,n.uX)(),(0,n.CE)("div",null,[(0,n.bF)(r,{isSidebarActive:a.isSidebarActive,onToggleSidebar:a.toggleSidebar},null,8,["isSidebarActive","onToggleSidebar"]),(0,n.Lk)("div",{class:(0,i.C4)(["main-content",{shifted:a.isSidebarActive}])},[(0,n.bF)(d,null,{default:(0,n.k6)((({Component:e})=>[e?((0,n.uX)(),(0,n.Wv)((0,n.$y)(e),{key:0})):(0,n.Q3)("",!0)])),_:1}),a.hasRouteComponent?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.CE)("div",Ln,yn))],2)])}var _n=o(144),Mn={name:"AppManagement",components:{Sidebar:$},setup(){const e=(0,_n.KR)(!1),t=(0,B.lq)(),o=(0,_n.KR)(!1);(0,n.wB)(t,(e=>{o.value=e.matched.length>1}),{immediate:!0});const a=()=>{e.value=!e.value};return{isSidebarActive:e,toggleSidebar:a,hasRouteComponent:o}}};const Pn=(0,h.A)(Mn,[["render",wn],["__scopeId","data-v-226d2503"]]);var En=Pn;const Rn=(0,n.Fv)('<div class="header" data-v-0d279a0b><h2 data-v-0d279a0b>儀表板管理</h2><div class="buttons" data-v-0d279a0b><button data-v-0d279a0b>新增圖表</button><button data-v-0d279a0b>編輯圖表</button></div></div><div class="chart-grid" data-v-0d279a0b><div class="chart" data-v-0d279a0b><h3 data-v-0d279a0b>銷售額</h3><canvas id="salesChart" data-v-0d279a0b></canvas></div><div class="chart" data-v-0d279a0b><h3 data-v-0d279a0b>營業額</h3><canvas id="usersChart" data-v-0d279a0b></canvas></div><div class="chart" data-v-0d279a0b><h3 data-v-0d279a0b>庫存量</h3><canvas id="storageChart" data-v-0d279a0b></canvas></div><div class="chart" data-v-0d279a0b><h3 data-v-0d279a0b>其他圖表</h3><canvas id="otherChart" data-v-0d279a0b></canvas></div></div>',2),Sn=[Rn];function Un(e,t,o,a,s,l){const r=(0,n.g2)("Sidebar");return(0,n.uX)(),(0,n.CE)("div",null,[(0,n.bF)(r,{isSidebarActive:s.isSidebarActive,onToggleSidebar:l.toggleSidebar},null,8,["isSidebarActive","onToggleSidebar"]),(0,n.Lk)("div",{class:(0,i.C4)(["main-content",{shifted:s.isSidebarActive}])},Sn,2)])}Be.t1.register(...Be.$L);var An={name:"AppDashboard",components:{Sidebar:$},data(){return{isSidebarActive:!1,salesChart:null,usersChart:null,storageChart:null,otherChart:null}},methods:{toggleSidebar(){this.isSidebarActive=!this.isSidebarActive},initializeCharts(){const e=document.getElementById("salesChart").getContext("2d");this.salesChart=new Be.t1(e,{type:"line",data:{labels:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],datasets:[{label:"Sales",data:[120,190,30,50,20,30,70],backgroundColor:"rgba(75, 192, 192, 0.2)",borderColor:"rgba(75, 192, 192, 1)",borderWidth:1}]}});const t=document.getElementById("usersChart").getContext("2d");this.usersChart=new Be.t1(t,{type:"line",data:{labels:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],datasets:[{label:"Users",data:[300,400,350,500,600,700,800],backgroundColor:"rgba(153, 102, 255, 0.2)",borderColor:"rgba(153, 102, 255, 1)",borderWidth:1}]}});const o=document.getElementById("storageChart").getContext("2d");this.storageChart=new Be.t1(o,{type:"bar",data:{labels:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],datasets:[{label:"Storage",data:[50,75,60,90,100,110,120],backgroundColor:"rgba(255, 159, 64, 0.2)",borderColor:"rgba(255, 159, 64, 1)",borderWidth:1}]}});const a=document.getElementById("otherChart").getContext("2d");this.otherChart=new Be.t1(a,{type:"doughnut",data:{labels:["Media","Document","Others"],datasets:[{label:"File Types",data:[50,30,20],backgroundColor:["rgba(255, 206, 86, 0.2)","rgba(54, 162, 235, 0.2)","rgba(75, 192, 192, 0.2)"],borderColor:["rgba(255, 206, 86, 1)","rgba(54, 162, 235, 1)","rgba(75, 192, 192, 1)"],borderWidth:1}]}})}},mounted(){this.initializeCharts()}};const Vn=(0,h.A)(An,[["render",Un],["__scopeId","data-v-0d279a0b"]]);var xn=Vn;const Fn=e=>((0,n.Qi)("data-v-9a3ce670"),e=e(),(0,n.jt)(),e),Tn={class:"container"},$n={class:"header"},In=Fn((()=>(0,n.Lk)("h2",null,"用戶管理",-1))),Xn={class:"filter-section"},qn=Fn((()=>(0,n.Lk)("label",{for:"sort-select"},"排序:",-1))),Bn=(0,n.Fv)('<option value="name" data-v-9a3ce670>姓名</option><option value="email" data-v-9a3ce670>電子郵件</option><option value="department" data-v-9a3ce670>部門</option><option value="position" data-v-9a3ce670>職位</option><option value="creation-time" data-v-9a3ce670>建立時間</option><option value="last-login" data-v-9a3ce670>最近登入時間</option>',6),Dn=[Bn],Jn=Fn((()=>(0,n.Lk)("label",{for:"department-select"},"部門:",-1))),Nn=Fn((()=>(0,n.Lk)("option",{value:"all"},"全部",-1))),Wn=["value"],jn={class:"user-table"},Qn=Fn((()=>(0,n.Lk)("thead",null,[(0,n.Lk)("tr",null,[(0,n.Lk)("th",null,"姓名"),(0,n.Lk)("th",null,"電子郵件"),(0,n.Lk)("th",null,"電話號碼"),(0,n.Lk)("th",null,"部門"),(0,n.Lk)("th",null,"職位"),(0,n.Lk)("th",null,"建立時間"),(0,n.Lk)("th",null,"最近登入時間"),(0,n.Lk)("th",null,"操作")])],-1))),zn=["onClick"],On=["onClick"],Hn=["onClick"];function Kn(e,t,o,s,l,r){return(0,n.uX)(),(0,n.CE)("div",Tn,[(0,n.Lk)("div",$n,[In,(0,n.Lk)("button",{id:"pending-approval-btn",class:"pending-approval-btn",onClick:t[0]||(t[0]=(...e)=>r.navigateToPendingList&&r.navigateToPendingList(...e))},"待審核")]),(0,n.Lk)("div",Xn,[qn,(0,n.bo)((0,n.Lk)("select",{id:"sort-select","onUpdate:modelValue":t[1]||(t[1]=e=>l.sortBy=e),onChange:t[2]||(t[2]=(...e)=>r.applyFilters&&r.applyFilters(...e))},Dn,544),[[a.u1,l.sortBy]]),Jn,(0,n.bo)((0,n.Lk)("select",{id:"department-select","onUpdate:modelValue":t[3]||(t[3]=e=>l.departmentFilter=e),onChange:t[4]||(t[4]=(...e)=>r.applyFilters&&r.applyFilters(...e))},[Nn,((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(l.departments,(e=>((0,n.uX)(),(0,n.CE)("option",{key:e,value:e},(0,i.v_)(e),9,Wn)))),128))],544),[[a.u1,l.departmentFilter]]),(0,n.bo)((0,n.Lk)("input",{type:"text",id:"search-box",placeholder:"搜尋...","onUpdate:modelValue":t[5]||(t[5]=e=>l.query=e),onKeydown:t[6]||(t[6]=(0,a.jR)(((...e)=>r.applyFilters&&r.applyFilters(...e)),["enter"]))},null,544),[[a.Jo,l.query]]),(0,n.Lk)("button",{onClick:t[7]||(t[7]=(...e)=>r.applyFilters&&r.applyFilters(...e)),class:"search-btn"},"搜尋")]),(0,n.Lk)("table",jn,[Qn,(0,n.Lk)("tbody",null,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(r.filteredUsers,(e=>((0,n.uX)(),(0,n.CE)("tr",{key:e.id},[(0,n.Lk)("td",null,(0,i.v_)(e.username),1),(0,n.Lk)("td",null,(0,i.v_)(e.email),1),(0,n.Lk)("td",null,(0,i.v_)(e.phone),1),(0,n.Lk)("td",null,(0,i.v_)(e.department_id),1),(0,n.Lk)("td",null,(0,i.v_)(e.position_id),1),(0,n.Lk)("td",null,(0,i.v_)(e.date_joined),1),(0,n.Lk)("td",null,(0,i.v_)(e.last_login),1),(0,n.Lk)("td",null,[(0,n.Lk)("button",{class:"edit-btn",onClick:t=>r.navigateToEditUser(e.id)},"編輯",8,zn),(0,n.Lk)("button",{class:"delete-btn",onClick:t=>r.deleteUser(e.id)},"刪除",8,On),(0,n.Lk)("button",{class:"assigning-roles-btn",onClick:t=>r.navigateToAssignRole(e.id)},"分配角色",8,Hn)])])))),128))])])])}var Zn={name:"UserManagement",data(){return{sortBy:"name",departmentFilter:"all",query:"",users:[],departments:["銷售部","人力資源部","資訊部","業務部","財務部"]}},computed:{filteredUsers(){let e=this.users;if("all"!==this.departmentFilter&&(e=e.filter((e=>e.department_id===this.departmentFilter))),this.query){const t=this.query.toLowerCase();e=e.filter((e=>e.username.toLowerCase().includes(t)||e.email.toLowerCase().includes(t)||e.phone.toLowerCase().includes(t)))}return e.sort(((e,t)=>"name"===this.sortBy?e.username.localeCompare(t.username):"email"===this.sortBy?e.email.localeCompare(t.email):"department"===this.sortBy?e.department_id.localeCompare(t.department_id):"position"===this.sortBy?e.position_id.localeCompare(t.position_id):"creation-time"===this.sortBy?new Date(e.date_joined)-new Date(t.date_joined):"last-login"===this.sortBy?new Date(e.last_login)-new Date(t.last_login):0))}},methods:{applyFilters(){console.log("Filters applied")},navigateToPendingList(){this.$router.push("/backend/pending_list")},navigateToEditUser(e){this.$router.push(`/backend/edit_user/${e}`)},navigateToAssignRole(e){this.$router.push(`/backend/assign_role/${e}`)},fetchUsers(){Wo.get("/api/backend/users/").then((e=>{this.users=e.data})).catch((e=>{console.error("Error fetching users:",e)}))},deleteUser(e){confirm("確定要刪除此用戶嗎？")&&Wo.delete(`/api/backend/delete_user/${e}/`).then((()=>{this.fetchUsers()})).catch((e=>{console.error("Error deleting user:",e)}))}},mounted(){this.fetchUsers()}};const Gn=(0,h.A)(Zn,[["render",Kn],["__scopeId","data-v-9a3ce670"]]);var Yn=Gn;const es=e=>((0,n.Qi)("data-v-36c9f245"),e=e(),(0,n.jt)(),e),ts={class:"header"},os=es((()=>(0,n.Lk)("h2",null,"角色管理",-1))),as=es((()=>(0,n.Lk)("option",{value:"all"},"所有模組",-1))),ns=["value"],ss={class:"role-table"},ls=es((()=>(0,n.Lk)("thead",null,[(0,n.Lk)("tr",null,[(0,n.Lk)("th",null,"角色名稱"),(0,n.Lk)("th",null,"角色狀態"),(0,n.Lk)("th",null,"用戶數"),(0,n.Lk)("th",null,"角色成員"),(0,n.Lk)("th",null,"模組"),(0,n.Lk)("th",null,"操作")])],-1))),is={id:"role-tbody"},rs=["data-module"],ds={class:"switch"},cs=["checked","onChange"],us=es((()=>(0,n.Lk)("span",{class:"slider"},null,-1))),ps=["onUpdate:modelValue"],ms=["value"],hs=["onClick"],ks=["onClick"];function bs(e,t,o,s,l,r){const d=(0,n.g2)("RoleForm"),c=(0,n.g2)("RoleModal");return(0,n.uX)(),(0,n.CE)("div",{class:(0,i.C4)(["container",{shifted:l.isSidebarActive}])},[(0,n.Lk)("div",ts,[os,(0,n.Lk)("button",{id:"add-role-btn",class:"btn add-role-btn",onClick:t[0]||(t[0]=(...e)=>r.openCreateRoleModal&&r.openCreateRoleModal(...e))},"新增角色"),(0,n.Lk)("button",{class:"btn",onClick:t[1]||(t[1]=(...e)=>r.navigateToRoleManagement&&r.navigateToRoleManagement(...e))},"角色"),(0,n.Lk)("button",{class:"btn",onClick:t[2]||(t[2]=(...e)=>r.navigateToModuleManagement&&r.navigateToModuleManagement(...e))},"模組")]),(0,n.bF)(c,{isVisible:l.showCreateRoleModal,onClose:r.closeCreateRoleModal},{default:(0,n.k6)((()=>[(0,n.bF)(d,{onRoleSaved:r.fetchRoles,onClose:r.closeCreateRoleModal},null,8,["onRoleSaved","onClose"])])),_:1},8,["isVisible","onClose"]),(0,n.bo)((0,n.Lk)("select",{id:"chart-module-select","onUpdate:modelValue":t[3]||(t[3]=e=>l.selectedModule=e),onChange:t[4]||(t[4]=(...e)=>r.filterRolesByModule&&r.filterRolesByModule(...e))},[as,((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(l.modules,(e=>((0,n.uX)(),(0,n.CE)("option",{key:e.id,value:e.id},(0,i.v_)(e.name),9,ns)))),128))],544),[[a.u1,l.selectedModule]]),(0,n.Lk)("table",ss,[ls,(0,n.Lk)("tbody",is,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(r.filteredRoles,(e=>((0,n.uX)(),(0,n.CE)("tr",{key:e.id,"data-module":e.module.id},[(0,n.Lk)("td",null,(0,i.v_)(e.name),1),(0,n.Lk)("td",null,[(0,n.Lk)("label",ds,[(0,n.Lk)("input",{type:"checkbox",checked:e.is_active,onChange:t=>r.toggleStatus(e.id,!e.is_active)},null,40,cs),us])]),(0,n.Lk)("td",null,(0,i.v_)(e.users.length),1),(0,n.Lk)("td",null,[(0,n.bo)((0,n.Lk)("select",{"onUpdate:modelValue":t=>e.selectedUser=t},[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(e.users,(e=>((0,n.uX)(),(0,n.CE)("option",{key:e.id,value:e.id},(0,i.v_)(e.username),9,ms)))),128))],8,ps),[[a.u1,e.selectedUser]])]),(0,n.Lk)("td",null,(0,i.v_)(e.module_name?e.module_name:"未知模組"),1),(0,n.Lk)("td",null,[(0,n.Lk)("button",{class:"permissions-btn",onClick:t=>r.openEditRoleModal(e.id)}," 編輯角色 ",8,hs),(0,n.Lk)("button",{class:"delete-btn",onClick:t=>r.deleteRole(e.id)}," 刪除 ",8,ks)])],8,rs)))),128))])]),(0,n.bF)(c,{isVisible:l.showEditRoleModal,onClose:r.closeEditRoleModal},{default:(0,n.k6)((()=>[(0,n.bF)(d,{roleId:l.editingRoleId,onRoleSaved:r.fetchRoles,onClose:r.closeEditRoleModal},null,8,["roleId","onRoleSaved","onClose"])])),_:1},8,["isVisible","onClose"])],2)}const fs={key:0,class:"modal-overlay"},vs={class:"modal"};function Ls(e,t,o,a,s,l){return o.isVisible?((0,n.uX)(),(0,n.CE)("div",fs,[(0,n.Lk)("div",vs,[(0,n.Lk)("button",{class:"close-btn",onClick:t[0]||(t[0]=t=>e.$emit("close"))},"X"),(0,n.RG)(e.$slots,"default",{},void 0,!0)])])):(0,n.Q3)("",!0)}var gs={name:"RoleModal",props:{isVisible:{type:Boolean,required:!0}},watch:{$route(e,t){"add-permission"===t.name&&"role-edit"===e.name&&this.$emit("close")}}};const Cs=(0,h.A)(gs,[["render",Ls],["__scopeId","data-v-a791de06"]]);var ys=Cs;const ws=e=>((0,n.Qi)("data-v-2d6614fc"),e=e(),(0,n.jt)(),e),_s={class:"container"},Ms={class:"form-group"},Ps=ws((()=>(0,n.Lk)("label",{for:"role-name"},"角色名稱",-1))),Es={class:"form-group"},Rs=ws((()=>(0,n.Lk)("label",{for:"role-users"},"角色成員",-1))),Ss={class:"member-container"},Us=["onUpdate:modelValue"],As=ws((()=>(0,n.Lk)("option",{value:""},"-- 選擇成員 --",-1))),Vs=["value"],xs=["onClick"],Fs={class:"form-group"},Ts=ws((()=>(0,n.Lk)("label",{for:"role-is-active"},"角色狀態",-1))),$s={class:"form-group"},Is=ws((()=>(0,n.Lk)("label",{for:"role-module"},"模組",-1))),Xs=ws((()=>(0,n.Lk)("option",{value:""},"-- 選擇模組 --",-1))),qs=["value"],Bs={class:"form-group"},Ds=ws((()=>(0,n.Lk)("label",null,"角色權限",-1))),Js=ws((()=>(0,n.Lk)("thead",null,[(0,n.Lk)("tr",null,[(0,n.Lk)("th",null,"功能"),(0,n.Lk)("th",null,"新增"),(0,n.Lk)("th",null,"查詢"),(0,n.Lk)("th",null,"檢視"),(0,n.Lk)("th",null,"修改"),(0,n.Lk)("th",null,"刪除"),(0,n.Lk)("th",null,"列印"),(0,n.Lk)("th",null,"匯出"),(0,n.Lk)("th",null,"維護"),(0,n.Lk)("th",null,"操作")])],-1))),Ns=["onUpdate:modelValue"],Ws=["onUpdate:modelValue"],js=["onUpdate:modelValue"],Qs=["onUpdate:modelValue"],zs=["onUpdate:modelValue"],Os=["onUpdate:modelValue"],Hs=["onUpdate:modelValue"],Ks=["onUpdate:modelValue"],Zs=["onClick"],Gs={type:"submit",class:"btn"};function Ys(e,t,o,s,l,r){return(0,n.uX)(),(0,n.CE)("div",_s,[(0,n.Lk)("h2",null,(0,i.v_)(l.isEdit?"編輯角色":"新增角色"),1),(0,n.Lk)("form",{onSubmit:t[7]||(t[7]=(0,a.D$)(((...e)=>r.saveRole&&r.saveRole(...e)),["prevent"]))},[(0,n.Lk)("div",Ms,[Ps,(0,n.bo)((0,n.Lk)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>l.localRole.name=e),id:"role-name",required:""},null,512),[[a.Jo,l.localRole.name]])]),(0,n.Lk)("div",Es,[Rs,(0,n.Lk)("div",Ss,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(l.localRole.users,((e,o)=>((0,n.uX)(),(0,n.CE)("div",{key:o,class:"member-item"},[(0,n.bo)((0,n.Lk)("select",{"onUpdate:modelValue":e=>l.localRole.users[o]=e,onChange:t[1]||(t[1]=(...e)=>r.updateMembers&&r.updateMembers(...e))},[As,((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(l.availableUsers,(e=>((0,n.uX)(),(0,n.CE)("option",{key:e.id,value:e.id},(0,i.v_)(e.username),9,Vs)))),128))],40,Us),[[a.u1,l.localRole.users[o]]]),(0,n.Lk)("button",{type:"button",onClick:e=>r.removeMember(o)},"-",8,xs)])))),128)),(0,n.Lk)("button",{type:"button",onClick:t[2]||(t[2]=(...e)=>r.addMember&&r.addMember(...e))},"+")])]),(0,n.Lk)("div",Fs,[Ts,(0,n.bo)((0,n.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[3]||(t[3]=e=>l.localRole.is_active=e),id:"role-is-active"},null,512),[[a.lH,l.localRole.is_active]])]),(0,n.Lk)("div",$s,[Is,(0,n.bo)((0,n.Lk)("select",{"onUpdate:modelValue":t[4]||(t[4]=e=>l.localRole.module=e),id:"role-module"},[Xs,((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(l.availableModules,(e=>((0,n.uX)(),(0,n.CE)("option",{key:e.id,value:e.id},(0,i.v_)(e.name),9,qs)))),128))],512),[[a.u1,l.localRole.module]])]),(0,n.Lk)("div",Bs,[Ds,(0,n.Lk)("table",null,[Js,(0,n.Lk)("tbody",null,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(e.rolePermissions,(e=>((0,n.uX)(),(0,n.CE)("tr",{key:e.id},[(0,n.Lk)("td",null,(0,i.v_)(e.permission_name),1),(0,n.Lk)("td",null,[(0,n.bo)((0,n.Lk)("input",{type:"checkbox","onUpdate:modelValue":t=>e.can_add=t},null,8,Ns),[[a.lH,e.can_add]])]),(0,n.Lk)("td",null,[(0,n.bo)((0,n.Lk)("input",{type:"checkbox","onUpdate:modelValue":t=>e.can_query=t},null,8,Ws),[[a.lH,e.can_query]])]),(0,n.Lk)("td",null,[(0,n.bo)((0,n.Lk)("input",{type:"checkbox","onUpdate:modelValue":t=>e.can_view=t},null,8,js),[[a.lH,e.can_view]])]),(0,n.Lk)("td",null,[(0,n.bo)((0,n.Lk)("input",{type:"checkbox","onUpdate:modelValue":t=>e.can_edit=t},null,8,Qs),[[a.lH,e.can_edit]])]),(0,n.Lk)("td",null,[(0,n.bo)((0,n.Lk)("input",{type:"checkbox","onUpdate:modelValue":t=>e.can_delete=t},null,8,zs),[[a.lH,e.can_delete]])]),(0,n.Lk)("td",null,[(0,n.bo)((0,n.Lk)("input",{type:"checkbox","onUpdate:modelValue":t=>e.can_print=t},null,8,Os),[[a.lH,e.can_print]])]),(0,n.Lk)("td",null,[(0,n.bo)((0,n.Lk)("input",{type:"checkbox","onUpdate:modelValue":t=>e.can_export=t},null,8,Hs),[[a.lH,e.can_export]])]),(0,n.Lk)("td",null,[(0,n.bo)((0,n.Lk)("input",{type:"checkbox","onUpdate:modelValue":t=>e.can_maintain=t},null,8,Ks),[[a.lH,e.can_maintain]])]),(0,n.Lk)("td",null,[(0,n.Lk)("button",{type:"button",onClick:t=>r.deletePermission(e.id)},"刪除",8,Zs)])])))),128))])]),(0,n.Lk)("button",{type:"button",onClick:t[5]||(t[5]=(...e)=>r.navigateToAddPermission&&r.navigateToAddPermission(...e))},"新增權限")]),(0,n.Lk)("button",Gs,(0,i.v_)(l.isEdit?"保存變更":"新增"),1),(0,n.Lk)("button",{type:"button",class:"btn secondary",onClick:t[6]||(t[6]=(...e)=>r.cancel&&r.cancel(...e))},"取消")],32)])}var el={name:"RoleForm",props:{roleId:{type:Number,default:null}},data(){return{localRole:{name:"",module:"",users:[],is_active:!1},availableUsers:[],availableModules:[],rolePermission:[],isEdit:!1}},methods:{async saveRole(){try{const e={...this.localRole,users:this.localRole.users,permissions:this.rolePermissions};console.log("Sending role data:",e);const t=this.isEdit?await Wo.put(`/api/backend/roles/${this.localRole.id}/`,e):await Wo.post("/api/backend/roles/",e);200===t.status||201===t.status?(alert("保存成功"),await this.fetchRolePermissions(this.localRole.id),this.$emit("role-saved"),this.$emit("close")):alert("保存失敗")}catch(e){console.error("Error saving role:",e.response?e.response.data:e.message),alert("保存失敗")}},async fetchUsers(){try{const e=await Wo.get("/api/backend/users/");this.availableUsers=e.data}catch(e){console.error("Error fetching users:",e)}},async fetchModules(){try{const e=await Wo.get("/api/backend/modules/");this.availableModules=e.data,console.log("Avaliable Modules:",this.availableModules)}catch(e){console.error("Error fetching modules:",e)}},addMember(){this.localRole.users.push("")},removeMember(e){this.localRole.users.splice(e,1)},updateMembers(){this.$forceUpdate()},cancel(){this.$emit("close")},async fetchRolePermissions(e){try{const t=await Wo.get(`/api/backend/role_permissions/?role_id=${e}`);this.rolePermissions=t.data}catch(t){console.error("Error fetching role permissions:",t)}},navigateToAddPermission(){this.$router.push(`/backend/role_permissions/${this.localRole.id}/`)},async deletePermission(e){try{const t=await Wo.delete(`/api/backend/role_permissions/${e}/`);204===t.status?(this.rolePermissions=this.rolePermissions.filter((t=>t.id!==e)),this.$forceUpdate(),alert("刪除成功")):alert("刪除失敗")}catch(t){console.error("刪除權限時出錯:",t.response?t.response.data:t.message),alert("刪除失敗")}},async loadRole(e){try{const t=await Wo.get(`/api/backend/roles/${e}/`),o=t.data;console.log("API返回的Role:",o),this.localRole={id:o.id,name:o.name,module:o.module?o.module:"",users:o.users.map((e=>e.id)),is_active:o.is_active},console.log("当前角色模块 ID:",this.localRole.module),await this.fetchRolePermissions(e),this.updateMembers(),this.$nextTick((()=>{console.log("DOM 更新完成，模块已加载:",this.localRole.module)}))}catch(t){console.error("加载角色信息时出错:",t.response?t.response.data:t.message)}}},async mounted(){await this.fetchModules(),await this.fetchUsers(),this.roleId&&(this.isEdit=!0,await this.loadRole(this.roleId))}};const tl=(0,h.A)(el,[["render",Ys],["__scopeId","data-v-2d6614fc"]]);var ol=tl,al={name:"RoleManagement",components:{RoleModal:ys,RoleForm:ol},data(){return{roles:[],modules:[],selectedModule:"all",showCreateRoleModal:!1,showEditRoleModal:!1,editingRoleId:null,isSidebarActive:!1}},computed:{filteredRoles(){return"all"===this.selectedModule?this.roles:this.roles.filter((e=>e.module==this.selectedModule))}},methods:{fetchRoles(){Wo.get("/api/backend/roles/").then((e=>{this.roles=e.data.map((e=>({...e,selectedUser:e.users.length?e.users[0].id:null})))})).catch((e=>{console.error("Error fetching roles:",e)}))},fetchModules(){Wo.get("/api/backend/modules/").then((e=>{this.modules=e.data.filter((e=>!e.is_deleted))})).catch((e=>{console.error("Error fetching modules:",e)}))},filterRolesByModule(){this.filteredRoles},openCreateRoleModal(){this.showCreateRoleModal=!0},closeCreateRoleModal(){this.showCreateRoleModal=!1},openEditRoleModal(e){this.editingRoleId=e,this.showEditRoleModal=!0},closeEditRoleModal(){this.showEditRoleModal=!1,this.editingRoleId=null},toggleStatus(e,t){Wo.post(`/api/backend/toggle_role_status/${e}/`,{is_active:t}).then((e=>{e.data.success?this.fetchRoles():alert("切換狀態失敗")})).catch((e=>{console.error("Error toggling status:",e),alert("切換狀態失敗")}))},navigateToRoleManagement(){this.$router.push("/backend/role-management")},navigateToModuleManagement(){this.$router.push("/backend/module-management")},deleteRole(e){confirm("確定要刪除此角色嗎？")&&Wo.post(`/api/backend/delete_role/${e}/`).then((()=>{this.fetchRoles()})).catch((e=>{console.error("Error deleting role:",e),alert("刪除角色失敗")}))}},mounted(){this.fetchRoles(),this.fetchModules()}};const nl=(0,h.A)(al,[["render",bs],["__scopeId","data-v-36c9f245"]]);var sl=nl;const ll=e=>((0,n.Qi)("data-v-4c3eb9ff"),e=e(),(0,n.jt)(),e),il={class:"container"},rl=ll((()=>(0,n.Lk)("a",{href:"/backend/user-management",class:"back-button"},[(0,n.Lk)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[(0,n.Lk)("path",{d:"M15 18L9 12L15 6",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})]),(0,n.eW)(" 回到用戶管理 ")],-1))),dl=ll((()=>(0,n.Lk)("h1",null,"待審核名單",-1))),cl={class:"pending-table"},ul=ll((()=>(0,n.Lk)("thead",null,[(0,n.Lk)("tr",null,[(0,n.Lk)("th",null,"姓名"),(0,n.Lk)("th",null,"電子郵件"),(0,n.Lk)("th",null,"電話號碼"),(0,n.Lk)("th",null,"申請時間"),(0,n.Lk)("th",null,"審核")])],-1))),pl=["onSubmit"],ml=ll((()=>(0,n.Lk)("button",{type:"submit",class:"approve-btn"},"開通",-1))),hl=[ml];function kl(e,t,o,s,l,r){return(0,n.uX)(),(0,n.CE)("div",il,[rl,dl,(0,n.Lk)("table",cl,[ul,(0,n.Lk)("tbody",null,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(l.pendingUsers,(t=>((0,n.uX)(),(0,n.CE)("tr",{key:t.id},[(0,n.Lk)("td",null,(0,i.v_)(t.username),1),(0,n.Lk)("td",null,(0,i.v_)(t.email),1),(0,n.Lk)("td",null,(0,i.v_)(t.phone),1),(0,n.Lk)("td",null,(0,i.v_)(t.date_joined?t.date_joined:"未知"),1),(0,n.Lk)("td",null,[(0,n.Lk)("form",{onSubmit:(0,a.D$)((o=>e.approveUser(t.id)),["prevent"])},hl,40,pl)])])))),128))])])])}var bl={name:"PendingList",data(){return{pendingUsers:[]}},methods:{async fetchPendingUsers(){try{const e=await Wo.get("/api/backend/pending-users/");this.pendingUsers=e.data}catch(e){console.error("Error fetching pending users:",e)}}},mounted(){this.fetchPendingUsers()}};const fl=(0,h.A)(bl,[["render",kl],["__scopeId","data-v-4c3eb9ff"]]);var vl=fl;const Ll=e=>((0,n.Qi)("data-v-26951bdb"),e=e(),(0,n.jt)(),e),gl={class:"container"},Cl=Ll((()=>(0,n.Lk)("h2",null,"編輯用戶",-1))),yl={class:"form-group"},wl=Ll((()=>(0,n.Lk)("label",{for:"username"},"姓名",-1))),_l={class:"form-group"},Ml=Ll((()=>(0,n.Lk)("label",{for:"email"},"電子郵件",-1))),Pl={class:"form-group"},El=Ll((()=>(0,n.Lk)("label",{for:"phone"},"電話號碼",-1))),Rl={class:"form-group"},Sl=Ll((()=>(0,n.Lk)("label",{for:"department"},"部門",-1))),Ul=Ll((()=>(0,n.Lk)("option",{value:""},"選擇部門",-1))),Al=["value"],Vl={class:"form-group"},xl=Ll((()=>(0,n.Lk)("label",{for:"position"},"職位",-1))),Fl=Ll((()=>(0,n.Lk)("option",{value:""},"選擇職位",-1))),Tl=["value"],$l={class:"form-group"},Il=Ll((()=>(0,n.Lk)("button",{type:"submit",class:"btn-save"},"儲存",-1)));function Xl(e,t,o,s,l,r){return(0,n.uX)(),(0,n.CE)("div",gl,[Cl,(0,n.Lk)("form",{onSubmit:t[6]||(t[6]=(0,a.D$)(((...e)=>r.updateUser&&r.updateUser(...e)),["prevent"]))},[(0,n.Lk)("div",yl,[wl,(0,n.bo)((0,n.Lk)("input",{type:"text",id:"username","onUpdate:modelValue":t[0]||(t[0]=e=>l.user.username=e),required:""},null,512),[[a.Jo,l.user.username]])]),(0,n.Lk)("div",_l,[Ml,(0,n.bo)((0,n.Lk)("input",{type:"email",id:"email","onUpdate:modelValue":t[1]||(t[1]=e=>l.user.email=e),required:""},null,512),[[a.Jo,l.user.email]])]),(0,n.Lk)("div",Pl,[El,(0,n.bo)((0,n.Lk)("input",{type:"text",id:"phone","onUpdate:modelValue":t[2]||(t[2]=e=>l.user.phone=e),required:""},null,512),[[a.Jo,l.user.phone]])]),(0,n.Lk)("div",Rl,[Sl,(0,n.bo)((0,n.Lk)("select",{id:"department","onUpdate:modelValue":t[3]||(t[3]=e=>l.user.department_id=e)},[Ul,((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(l.departments,(e=>((0,n.uX)(),(0,n.CE)("option",{key:e,value:e},(0,i.v_)(e),9,Al)))),128))],512),[[a.u1,l.user.department_id]])]),(0,n.Lk)("div",Vl,[xl,(0,n.bo)((0,n.Lk)("select",{id:"position","onUpdate:modelValue":t[4]||(t[4]=e=>l.user.position_id=e)},[Fl,((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(l.positions,(e=>((0,n.uX)(),(0,n.CE)("option",{key:e,value:e},(0,i.v_)(e),9,Tl)))),128))],512),[[a.u1,l.user.position_id]])]),(0,n.Lk)("div",$l,[Il,(0,n.Lk)("button",{type:"button",class:"btn-cancel",onClick:t[5]||(t[5]=(...e)=>r.cancelEdit&&r.cancelEdit(...e))},"取消")])],32)])}var ql={name:"EditUser",data(){return{user:{username:"",email:"",phone:"",department_id:"",position_id:""},departments:["銷售部","人力資源部","資訊部","業務部","財務部"],positions:["經理","主管","員工"]}},methods:{fetchUser(){const e=this.$route.params.userId;Wo.get(`/api/backend/users/${e}/`).then((e=>{this.user=e.data})).catch((e=>{console.error("Error fetching user:",e)}))},updateUser(){const e=this.$route.params.userId;Wo.put(`/api/users/${e}/`,this.user).then((()=>{this.$router.push("/backend/user-management")})).catch((e=>{console.error("Error updating user:",e)}))},cancelEdit(){this.$router.push("/backend/user-management")}},mounted(){this.fetchUser()}};const Bl=(0,h.A)(ql,[["render",Xl],["__scopeId","data-v-26951bdb"]]);var Dl=Bl;const Jl=e=>((0,n.Qi)("data-v-114ec4b6"),e=e(),(0,n.jt)(),e),Nl={class:"container"},Wl=Jl((()=>(0,n.Lk)("label",{for:"module"},"選擇模組:",-1))),jl=Jl((()=>(0,n.Lk)("option",{value:""},"-- 選擇模組 --",-1))),Ql=["value"],zl=Jl((()=>(0,n.Lk)("label",{for:"role"},"選擇角色:",-1))),Ol=Jl((()=>(0,n.Lk)("option",{value:""},"-- 選擇角色 --",-1))),Hl=["value"],Kl=Jl((()=>(0,n.Lk)("button",{type:"submit"},"保存",-1)));function Zl(e,t,o,s,l,r){return(0,n.uX)(),(0,n.CE)("div",Nl,[(0,n.Lk)("h2",null,"分配角色和模組給 "+(0,i.v_)(l.user.username),1),(0,n.Lk)("form",{onSubmit:t[3]||(t[3]=(0,a.D$)(((...e)=>r.assignRoleAndModule&&r.assignRoleAndModule(...e)),["prevent"]))},[Wl,(0,n.bo)((0,n.Lk)("select",{id:"module","onUpdate:modelValue":t[0]||(t[0]=e=>l.selectedModule=e),onChange:t[1]||(t[1]=(...e)=>r.loadRoles&&r.loadRoles(...e))},[jl,((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(l.modules,(e=>((0,n.uX)(),(0,n.CE)("option",{key:e.id,value:e.id},(0,i.v_)(e.name),9,Ql)))),128))],544),[[a.u1,l.selectedModule]]),zl,(0,n.bo)((0,n.Lk)("select",{id:"role","onUpdate:modelValue":t[2]||(t[2]=e=>l.selectedRole=e)},[Ol,((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(l.roles,(e=>((0,n.uX)(),(0,n.CE)("option",{key:e.id,value:e.id},(0,i.v_)(e.name),9,Hl)))),128))],512),[[a.u1,l.selectedRole]]),Kl],32),(0,n.Lk)("button",{onClick:t[4]||(t[4]=(...e)=>r.goBack&&r.goBack(...e))},"回到上一頁")])}var Gl={name:"AssignRoleAndModule",data(){return{selectedModule:"",selectedRole:"",modules:[],roles:[],user:{}}},methods:{loadModules(){Wo.get("/api/backend/get_modules/").then((e=>{this.modules=e.data})).catch((e=>{console.error("Error loading modules:",e)}))},loadRoles(){this.selectedModule?Wo.get(`/api/backend/get_roles_by_module/${this.selectedModule}/`).then((e=>{this.roles=e.data,this.roles.some((e=>e.id===this.selectedRole))||(this.selectedRole="")})).catch((e=>{console.error("Error loading roles:",e)})):this.roles=[]},assignRoleAndModule(){const e=this.$route.params.userId;Wo.post(`/api/backend/assign_role_and_module/${e}/`,{module:this.selectedModule,role:this.selectedRole}).then((e=>{e.data.success?(alert("保存成功"),this.$router.push({name:"userManagement"})):alert("保存失敗")})).catch((e=>{console.error("Error saving role and module:",e),alert("保存失敗")}))},goBack(){this.$router.go(-1)},loadUser(){const e=this.$route.params.userId;Wo.get(`/api/backend/users/${e}/`).then((e=>{this.user=e.data,console.log(this.user),this.selectedModule=this.user.module?this.user.module.id:"",this.selectedRole=this.user.roles.length>0?this.user.roles[0].id:"",this.selectedModule&&this.loadRoles()})).catch((e=>{console.error("載入用戶資料時發生錯誤:",e)}))}},mounted(){this.loadModules(),this.loadUser()}};const Yl=(0,h.A)(Gl,[["render",Zl],["__scopeId","data-v-114ec4b6"]]);var ei=Yl;const ti=e=>((0,n.Qi)("data-v-245fdfa5"),e=e(),(0,n.jt)(),e),oi={class:"header"},ai=ti((()=>(0,n.Lk)("h2",null,"模組管理",-1))),ni={class:"btn-group"},si={class:"module-table"},li=ti((()=>(0,n.Lk)("thead",null,[(0,n.Lk)("tr",null,[(0,n.Lk)("th",null,"模組名稱"),(0,n.Lk)("th",null,"用戶數"),(0,n.Lk)("th",null,"操作")])],-1))),ii=["onClick"],ri=["onClick"];function di(e,t,o,a,s,l){const r=(0,n.g2)("ModuleForm");return(0,n.uX)(),(0,n.CE)("div",null,[(0,n.Lk)("div",{class:(0,i.C4)(["container",{shifted:s.isSidebarActive}])},[(0,n.Lk)("div",oi,[ai,(0,n.Lk)("div",ni,[(0,n.Lk)("button",{id:"add-module-btn",class:"btn add-module-btn",onClick:t[0]||(t[0]=(...e)=>l.openCreateModuleModal&&l.openCreateModuleModal(...e))},"新增模組"),(0,n.Lk)("button",{class:"btn",onClick:t[1]||(t[1]=(...e)=>l.navigateToRoleManagement&&l.navigateToRoleManagement(...e))},"角色"),(0,n.Lk)("button",{class:"btn",onClick:t[2]||(t[2]=(...e)=>l.navigateToModuleManagement&&l.navigateToModuleManagement(...e))},"模組")])]),(0,n.Lk)("table",si,[li,(0,n.Lk)("tbody",null,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(s.modules,(e=>((0,n.uX)(),(0,n.CE)("tr",{key:e.id},[(0,n.Lk)("td",null,(0,i.v_)(e.name),1),(0,n.Lk)("td",null,(0,i.v_)(l.getUserCount(e.id)),1),(0,n.Lk)("td",null,[(0,n.Lk)("button",{class:"edit-btn",onClick:t=>l.openEditModuleModal(e.id,e.name)},"編輯",8,ii),(0,n.Lk)("button",{class:"delete-btn",onClick:t=>l.deleteModule(e.id)},"刪除",8,ri)])])))),128))])]),s.showCreateModuleModal?((0,n.uX)(),(0,n.Wv)(r,{key:0,onClose:l.closeCreateModuleModal,onCreate:l.createModule},null,8,["onClose","onCreate"])):(0,n.Q3)("",!0),s.showEditModuleModal?((0,n.uX)(),(0,n.Wv)(r,{key:1,moduleId:s.editModuleId,moduleName:s.editModuleName,onClose:l.closeEditModuleModal,onEdit:l.editModule},null,8,["moduleId","moduleName","onClose","onEdit"])):(0,n.Q3)("",!0)],2)])}const ci=e=>((0,n.Qi)("data-v-4b7b9413"),e=e(),(0,n.jt)(),e),ui={class:"container"},pi={class:"form-group"},mi=ci((()=>(0,n.Lk)("label",{for:"module-name"},"模組名稱",-1))),hi={type:"submit",class:"btn"};function ki(e,t,o,s,l,r){return(0,n.uX)(),(0,n.CE)("div",ui,[(0,n.Lk)("h2",null,(0,i.v_)(o.moduleId?"編輯模組":"新增模組"),1),(0,n.Lk)("form",{onSubmit:t[2]||(t[2]=(0,a.D$)(((...e)=>r.handleSubmit&&r.handleSubmit(...e)),["prevent"]))},[(0,n.Lk)("div",pi,[mi,(0,n.bo)((0,n.Lk)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>l.localModuleName=e),id:"module-name",required:""},null,512),[[a.Jo,l.localModuleName]])]),(0,n.Lk)("button",hi,(0,i.v_)(o.moduleId?"保存變更":"新增"),1),(0,n.Lk)("button",{type:"button",class:"btn secondary",onClick:t[1]||(t[1]=(...e)=>r.close&&r.close(...e))},"取消")],32)])}var bi={name:"ModuleForm",props:{moduleId:{type:[String,Number],default:null},moduleName:{type:String,default:""}},data(){return{localModuleName:this.moduleName}},methods:{close(){this.$emit("close")},handleSubmit(){const e={name:this.localModuleName};this.moduleId?this.$emit("edit",e):this.$emit("create",e)}}};const fi=(0,h.A)(bi,[["render",ki],["__scopeId","data-v-4b7b9413"]]);var vi=fi,Li={name:"ModuleManagement",components:{ModuleForm:vi},data(){return{modules:[],showCreateModuleModal:!1,showEditModuleModal:!1,newModuleName:"",editModuleName:"",editModuleId:null,isSidebarActive:!1}},methods:{async loadModules(){try{const e=await Wo.get("/api/backend/modules/");console.log("Modules from backend:",e.data),this.modules=e.data.filter((e=>!e.is_deleted))||[]}catch(e){console.error("Error fetching modules:",e.response?e.response.data:e.message)}},openCreateModuleModal(){this.showCreateModuleModal=!0},closeCreateModuleModal(){this.showCreateModuleModal=!1},async createModule(e){try{const t=await Wo.post("/api/backend/modules/",e);201===t.status?(this.loadModules(),this.closeCreateModuleModal(),alert("新增模組成功")):alert("新增模組失敗")}catch(t){console.error("Error creating module:",t.response?t.response.data:t.message),alert("新增模組失敗")}},openEditModuleModal(e,t){this.editModuleId=e,this.editModuleName=t,this.showEditModuleModal=!0},closeEditModuleModal(){this.showEditModuleModal=!1},async editModule(e){try{const t=await Wo.put(`/api/backend/modules/${this.editModuleId}/`,e);200===t.status?(this.loadModules(),this.closeEditModuleModal(),alert("編輯模組成功")):alert("編輯模組失敗")}catch(t){console.error("Error editing module:",t.response?t.response.data:t.message),alert("編輯模組失敗")}},async deleteModule(e){try{const t=await Wo.delete(`/api/backend/modules/${e}/`);console.log("Delete response:",t),204===t.status?(this.loadModules(),alert("刪除成功")):(alert("刪除模組失敗"),console.error("Error deleting module:",t.data.message))}catch(t){console.error("Error deleting module:",t.response?t.response.data:t.message),alert("刪除模組失敗")}},navigateToRoleManagement(){this.$router.push("/backend/role-management")},navigateToModuleManagement(){this.$router.push("/backend/module-management")},getUserCount(e){const t=this.modules.find((t=>t.id===e));return t?t.user_count:0},toggleSidebar(){this.isSidebarActive=!this.isSidebarActive}},created(){this.loadModules()}};const gi=(0,h.A)(Li,[["render",di],["__scopeId","data-v-245fdfa5"]]);var Ci=gi;const yi=e=>((0,n.Qi)("data-v-03df9c06"),e=e(),(0,n.jt)(),e),wi={class:"container"},_i=yi((()=>(0,n.Lk)("h2",null,"新增權限",-1))),Mi={class:"form-group"},Pi=yi((()=>(0,n.Lk)("label",{for:"permission-name"},"功能名稱",-1))),Ei={class:"form-group"},Ri=yi((()=>(0,n.Lk)("h3",null,"權限",-1))),Si={class:"checkbox-container"};function Ui(e,t,o,s,l,i){return(0,n.uX)(),(0,n.CE)("div",wi,[_i,(0,n.Lk)("div",Mi,[Pi,(0,n.bo)((0,n.Lk)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>l.newPermission.permission_name=e),id:"permission-name",required:""},null,512),[[a.Jo,l.newPermission.permission_name]])]),(0,n.Lk)("div",Ei,[Ri,(0,n.Lk)("div",Si,[(0,n.Lk)("label",null,[(0,n.bo)((0,n.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[1]||(t[1]=e=>l.newPermission.can_add=e)},null,512),[[a.lH,l.newPermission.can_add]]),(0,n.eW)(" 新增")]),(0,n.Lk)("label",null,[(0,n.bo)((0,n.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[2]||(t[2]=e=>l.newPermission.can_query=e)},null,512),[[a.lH,l.newPermission.can_query]]),(0,n.eW)(" 查詢")]),(0,n.Lk)("label",null,[(0,n.bo)((0,n.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[3]||(t[3]=e=>l.newPermission.can_view=e)},null,512),[[a.lH,l.newPermission.can_view]]),(0,n.eW)(" 檢視")]),(0,n.Lk)("label",null,[(0,n.bo)((0,n.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[4]||(t[4]=e=>l.newPermission.can_edit=e)},null,512),[[a.lH,l.newPermission.can_edit]]),(0,n.eW)(" 修改")]),(0,n.Lk)("label",null,[(0,n.bo)((0,n.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[5]||(t[5]=e=>l.newPermission.can_delete=e)},null,512),[[a.lH,l.newPermission.can_delete]]),(0,n.eW)(" 刪除")]),(0,n.Lk)("label",null,[(0,n.bo)((0,n.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[6]||(t[6]=e=>l.newPermission.can_print=e)},null,512),[[a.lH,l.newPermission.can_print]]),(0,n.eW)(" 列印")]),(0,n.Lk)("label",null,[(0,n.bo)((0,n.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[7]||(t[7]=e=>l.newPermission.can_export=e)},null,512),[[a.lH,l.newPermission.can_export]]),(0,n.eW)(" 匯出")]),(0,n.Lk)("label",null,[(0,n.bo)((0,n.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[8]||(t[8]=e=>l.newPermission.can_maintain=e)},null,512),[[a.lH,l.newPermission.can_maintain]]),(0,n.eW)(" 維護")])])]),(0,n.Lk)("button",{onClick:t[9]||(t[9]=(...e)=>i.savePermission&&i.savePermission(...e))},"新增"),(0,n.Lk)("button",{onClick:t[10]||(t[10]=(...e)=>i.cancelPermission&&i.cancelPermission(...e))},"取消")])}var Ai={data(){return{newPermission:{permission_name:"",can_add:!1,can_query:!1,can_view:!1,can_edit:!1,can_delete:!1,can_print:!1,can_export:!1,can_maintain:!1}}},methods:{async savePermission(){try{const e=await Wo.post("/api/backend/role_permissions/",{...this.newPermission,role:this.$route.params.roleId});e.status>=200&&e.status<300?(alert("新增成功"),this.$emit("permission-saved"),this.$router.back()):alert("新增失敗")}catch(e){console.error("Error saving permission:",e.response?e.response.data:e.message),alert(`新增失敗: ${e.response?e.response.data.detail:e.message}`)}},cancelPermission(){this.$emit("permission-cancelled"),this.$router.back()}}};const Vi=(0,h.A)(Ai,[["render",Ui],["__scopeId","data-v-03df9c06"]]);var xi=Vi;const Fi=e=>((0,n.Qi)("data-v-798f7cc6"),e=e(),(0,n.jt)(),e),Ti={class:"search-container"},$i={class:"modal-content"},Ii=Fi((()=>(0,n.Lk)("label",{for:"userName"},"用戶:",-1))),Xi=Fi((()=>(0,n.Lk)("br",null,null,-1))),qi=Fi((()=>(0,n.Lk)("br",null,null,-1))),Bi=Fi((()=>(0,n.Lk)("label",{for:"userAction"},"操作:",-1))),Di=Fi((()=>(0,n.Lk)("br",null,null,-1))),Ji=Fi((()=>(0,n.Lk)("br",null,null,-1))),Ni=Fi((()=>(0,n.Lk)("label",{for:"userEmail"},"電子郵件:",-1))),Wi=Fi((()=>(0,n.Lk)("br",null,null,-1))),ji=Fi((()=>(0,n.Lk)("br",null,null,-1))),Qi=Fi((()=>(0,n.Lk)("label",{for:"timestamp"},"操作時間:",-1))),zi=Fi((()=>(0,n.Lk)("br",null,null,-1))),Oi=Fi((()=>(0,n.Lk)("br",null,null,-1))),Hi=Fi((()=>(0,n.Lk)("button",{type:"submit"},"新增紀錄",-1))),Ki={class:"history-container"},Zi=Fi((()=>(0,n.Lk)("h2",null,"歷史紀錄",-1))),Gi={class:"history-table",id:"history-table"},Yi=Fi((()=>(0,n.Lk)("thead",null,[(0,n.Lk)("tr",null,[(0,n.Lk)("th",null,"編號"),(0,n.Lk)("th",null,"用戶"),(0,n.Lk)("th",null,"歷史操作"),(0,n.Lk)("th",null,"電子郵件"),(0,n.Lk)("th",null,"操作時間")])],-1)));function er(e,t,o,s,l,r){return(0,n.uX)(),(0,n.CE)("div",null,[(0,n.Lk)("div",{class:(0,i.C4)(["container",{shifted:l.isSidebarActive}])},[(0,n.Lk)("div",Ti,[(0,n.bo)((0,n.Lk)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>l.searchQuery=e),placeholder:"查尋歷史紀錄..."},null,512),[[a.Jo,l.searchQuery]]),(0,n.Lk)("button",{onClick:t[1]||(t[1]=(...e)=>r.searchHistory&&r.searchHistory(...e))},"查尋"),(0,n.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>r.refreshPage&&r.refreshPage(...e))},"重整")]),l.isAddRecordModalVisible?((0,n.uX)(),(0,n.CE)("div",{key:0,class:"modal",onClick:t[9]||(t[9]=(0,a.D$)((e=>r.closeModal("addRecordModal")),["self"]))},[(0,n.Lk)("div",$i,[(0,n.Lk)("span",{class:"close",onClick:t[3]||(t[3]=e=>r.closeModal("addRecordModal"))},"×"),(0,n.Lk)("form",{onSubmit:t[8]||(t[8]=(0,a.D$)(((...e)=>r.addRecord&&r.addRecord(...e)),["prevent"]))},[Ii,(0,n.bo)((0,n.Lk)("input",{type:"text","onUpdate:modelValue":t[4]||(t[4]=e=>l.newRecord.userName=e),required:""},null,512),[[a.Jo,l.newRecord.userName]]),Xi,qi,Bi,(0,n.bo)((0,n.Lk)("input",{type:"text","onUpdate:modelValue":t[5]||(t[5]=e=>l.newRecord.userAction=e),required:""},null,512),[[a.Jo,l.newRecord.userAction]]),Di,Ji,Ni,(0,n.bo)((0,n.Lk)("input",{type:"email","onUpdate:modelValue":t[6]||(t[6]=e=>l.newRecord.userEmail=e),required:""},null,512),[[a.Jo,l.newRecord.userEmail]]),Wi,ji,Qi,(0,n.bo)((0,n.Lk)("input",{type:"datetime-local","onUpdate:modelValue":t[7]||(t[7]=e=>l.newRecord.timestamp=e),required:""},null,512),[[a.Jo,l.newRecord.timestamp]]),zi,Oi,Hi],32)])])):(0,n.Q3)("",!0),(0,n.Lk)("div",Ki,[Zi,(0,n.Lk)("table",Gi,[Yi,(0,n.Lk)("tbody",null,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(r.filteredRecords,((e,t)=>((0,n.uX)(),(0,n.CE)("tr",{key:t},[(0,n.Lk)("td",null,(0,i.v_)(t+1),1),(0,n.Lk)("td",null,(0,i.v_)(e.userName),1),(0,n.Lk)("td",null,(0,i.v_)(e.userAction),1),(0,n.Lk)("td",null,(0,i.v_)(e.userEmail),1),(0,n.Lk)("td",null,(0,i.v_)(e.timestamp),1)])))),128))])])])],2)])}var tr={name:"HistoricalRecord",data(){return{searchQuery:"",isAddRecordModalVisible:!1,newRecord:{userName:"",userAction:"",userEmail:"",timestamp:""},records:[{userName:"張三",userAction:"新增角色",userEmail:"zhangsan@example.com",timestamp:"2024-05-30 10:00"},{userName:"李四",userAction:"刪除角色",userEmail:"lisi@example.com",timestamp:"2024-05-30 11:00"}],isSidebarActive:!1}},computed:{filteredRecords(){return this.records.filter((e=>Object.values(e).some((e=>e.toLowerCase().includes(this.searchQuery.toLowerCase())))))}},methods:{openModal(e){"addRecordModal"===e&&(this.isAddRecordModalVisible=!0)},closeModal(e){"addRecordModal"===e&&(this.isAddRecordModalVisible=!1)},addRecord(){this.records.push({...this.newRecord}),this.newRecord={userName:"",userAction:"",userEmail:"",timestamp:""},this.closeModal("addRecordModal")},searchHistory(){},refreshPage(){window.location.reload()},collectAndSendData(){}},mounted(){this.collectAndSendData()}};const or=(0,h.A)(tr,[["render",er],["__scopeId","data-v-798f7cc6"]]);var ar=or;const nr=e=>((0,n.Qi)("data-v-881fb4f6"),e=e(),(0,n.jt)(),e),sr={class:"app-container"},lr=nr((()=>(0,n.Lk)("h1",null,"個人偏好管理",-1))),ir={class:"form-group"},rr=nr((()=>(0,n.Lk)("label",{for:"font-size"},"字體大小:",-1))),dr=nr((()=>(0,n.Lk)("option",{value:"small"},"小",-1))),cr=nr((()=>(0,n.Lk)("option",{value:"medium"},"中",-1))),ur=nr((()=>(0,n.Lk)("option",{value:"large"},"大",-1))),pr=[dr,cr,ur],mr={class:"form-group"},hr=nr((()=>(0,n.Lk)("label",{for:"notifications"},"通知:",-1))),kr={class:"form-group"},br=nr((()=>(0,n.Lk)("label",{for:"auto-login"},"自動登入:",-1))),fr={class:"form-group"},vr=nr((()=>(0,n.Lk)("label",{for:"verification"},"驗證:",-1))),Lr={class:"btn-container"},gr=nr((()=>(0,n.Lk)("button",{type:"submit",class:"btn"},"保存更改",-1))),Cr={key:0,class:"success-message"},yr={key:1,class:"modal"},wr={class:"modal-content"},_r=nr((()=>(0,n.Lk)("h2",null,"新增個人偏好",-1))),Mr={class:"form-group"},Pr=nr((()=>(0,n.Lk)("label",{for:"add-font-size"},"字體大小:",-1))),Er=nr((()=>(0,n.Lk)("option",{value:"small"},"小",-1))),Rr=nr((()=>(0,n.Lk)("option",{value:"medium"},"中",-1))),Sr=nr((()=>(0,n.Lk)("option",{value:"large"},"大",-1))),Ur=[Er,Rr,Sr],Ar={class:"form-group"},Vr=nr((()=>(0,n.Lk)("label",{for:"add-notifications"},"通知:",-1))),xr={class:"form-group"},Fr=nr((()=>(0,n.Lk)("label",{for:"add-auto-login"},"自動登入:",-1))),Tr={class:"form-group"},$r=nr((()=>(0,n.Lk)("label",{for:"add-verification"},"驗證:",-1))),Ir={class:"btn-container"},Xr=nr((()=>(0,n.Lk)("button",{type:"submit",class:"btn"},"保存",-1))),qr=nr((()=>(0,n.Lk)("h2",null,"查詢個人偏好",-1))),Br={class:"form-group"},Dr=nr((()=>(0,n.Lk)("label",{for:"query-font-size"},"字體大小:",-1))),Jr=nr((()=>(0,n.Lk)("option",{value:""},"--選擇--",-1))),Nr=nr((()=>(0,n.Lk)("option",{value:"small"},"小",-1))),Wr=nr((()=>(0,n.Lk)("option",{value:"medium"},"中",-1))),jr=nr((()=>(0,n.Lk)("option",{value:"large"},"大",-1))),Qr=[Jr,Nr,Wr,jr],zr={class:"form-group"},Or=nr((()=>(0,n.Lk)("label",{for:"query-notifications"},"通知:",-1))),Hr=nr((()=>(0,n.Lk)("option",{value:""},"--選擇--",-1))),Kr=nr((()=>(0,n.Lk)("option",{value:"true"},"啟用",-1))),Zr=nr((()=>(0,n.Lk)("option",{value:"false"},"不啟用",-1))),Gr=[Hr,Kr,Zr],Yr={class:"form-group"},ed=nr((()=>(0,n.Lk)("label",{for:"query-auto-login"},"自動登入:",-1))),td=nr((()=>(0,n.Lk)("option",{value:""},"--選擇--",-1))),od=nr((()=>(0,n.Lk)("option",{value:"true"},"啟用",-1))),ad=nr((()=>(0,n.Lk)("option",{value:"false"},"不啟用",-1))),nd=[td,od,ad],sd={class:"form-group"},ld=nr((()=>(0,n.Lk)("label",{for:"query-verification"},"驗證:",-1))),id=nr((()=>(0,n.Lk)("option",{value:""},"--選擇--",-1))),rd=nr((()=>(0,n.Lk)("option",{value:"true"},"啟用",-1))),dd=nr((()=>(0,n.Lk)("option",{value:"false"},"不啟用",-1))),cd=[id,rd,dd],ud=nr((()=>(0,n.Lk)("div",{class:"btn-container"},[(0,n.Lk)("button",{type:"submit",class:"btn"},"查詢")],-1))),pd={key:2,class:"results"},md=nr((()=>(0,n.Lk)("thead",null,[(0,n.Lk)("tr",null,[(0,n.Lk)("th",null,"ID"),(0,n.Lk)("th",null,"字體大小"),(0,n.Lk)("th",null,"通知"),(0,n.Lk)("th",null,"自動登入"),(0,n.Lk)("th",null,"驗證")])],-1))),hd={key:3,class:"results"};function kd(e,t,o,s,l,r){return(0,n.uX)(),(0,n.CE)("div",sr,[(0,n.Lk)("div",{class:(0,i.C4)(["app-content",{shifted:l.isSidebarActive}])},[lr,(0,n.Lk)("form",{onSubmit:t[7]||(t[7]=(0,a.D$)(((...e)=>r.updatePreferences&&r.updatePreferences(...e)),["prevent"]))},[(0,n.Lk)("div",ir,[rr,(0,n.bo)((0,n.Lk)("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>l.preferences.font_size=e),id:"font-size"},pr,512),[[a.u1,l.preferences.font_size]])]),(0,n.Lk)("div",mr,[hr,(0,n.bo)((0,n.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[1]||(t[1]=e=>l.preferences.notifications=e),id:"notifications"},null,512),[[a.lH,l.preferences.notifications]]),(0,n.eW)(" 啟用通知 ")]),(0,n.Lk)("div",kr,[br,(0,n.bo)((0,n.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[2]||(t[2]=e=>l.preferences.auto_login=e),id:"auto-login"},null,512),[[a.lH,l.preferences.auto_login]]),(0,n.eW)(" 啟用自動登入 ")]),(0,n.Lk)("div",fr,[vr,(0,n.bo)((0,n.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[3]||(t[3]=e=>l.preferences.verification=e),id:"verification"},null,512),[[a.lH,l.preferences.verification]]),(0,n.eW)(" 啟用驗證 ")]),(0,n.Lk)("div",Lr,[gr,(0,n.Lk)("button",{type:"button",class:"btn",onClick:t[4]||(t[4]=(...e)=>r.showAddModal&&r.showAddModal(...e))},"新增"),(0,n.Lk)("button",{type:"button",class:"btn btn-delete",onClick:t[5]||(t[5]=(...e)=>r.deletePreference&&r.deletePreference(...e))},"刪除"),(0,n.Lk)("button",{type:"button",class:"btn btn-cancel",onClick:t[6]||(t[6]=(...e)=>r.resetPreferences&&r.resetPreferences(...e))},"取消更改")])],32),l.successMessage?((0,n.uX)(),(0,n.CE)("div",Cr,"保存成功！")):(0,n.Q3)("",!0),l.showModal?((0,n.uX)(),(0,n.CE)("div",yr,[(0,n.Lk)("div",wr,[(0,n.Lk)("span",{class:"close",onClick:t[8]||(t[8]=(...e)=>r.closeAddModal&&r.closeAddModal(...e))},"×"),_r,(0,n.Lk)("form",{onSubmit:t[14]||(t[14]=(0,a.D$)(((...e)=>r.addPreference&&r.addPreference(...e)),["prevent"]))},[(0,n.Lk)("div",Mr,[Pr,(0,n.bo)((0,n.Lk)("select",{"onUpdate:modelValue":t[9]||(t[9]=e=>l.newPreference.font_size=e),id:"add-font-size"},Ur,512),[[a.u1,l.newPreference.font_size]])]),(0,n.Lk)("div",Ar,[Vr,(0,n.bo)((0,n.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[10]||(t[10]=e=>l.newPreference.notifications=e),id:"add-notifications"},null,512),[[a.lH,l.newPreference.notifications]]),(0,n.eW)(" 啟用通知 ")]),(0,n.Lk)("div",xr,[Fr,(0,n.bo)((0,n.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[11]||(t[11]=e=>l.newPreference.auto_login=e),id:"add-auto-login"},null,512),[[a.lH,l.newPreference.auto_login]]),(0,n.eW)(" 啟用自動登入 ")]),(0,n.Lk)("div",Tr,[$r,(0,n.bo)((0,n.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[12]||(t[12]=e=>l.newPreference.verification=e),id:"add-verification"},null,512),[[a.lH,l.newPreference.verification]]),(0,n.eW)(" 啟用驗證 ")]),(0,n.Lk)("div",Ir,[Xr,(0,n.Lk)("button",{type:"button",class:"btn btn-cancel",onClick:t[13]||(t[13]=(...e)=>r.closeAddModal&&r.closeAddModal(...e))},"取消")])],32)])])):(0,n.Q3)("",!0),qr,(0,n.Lk)("form",{onSubmit:t[19]||(t[19]=(0,a.D$)(((...e)=>r.queryPreferences&&r.queryPreferences(...e)),["prevent"]))},[(0,n.Lk)("div",Br,[Dr,(0,n.bo)((0,n.Lk)("select",{"onUpdate:modelValue":t[15]||(t[15]=e=>l.query.font_size=e),id:"query-font-size"},Qr,512),[[a.u1,l.query.font_size]])]),(0,n.Lk)("div",zr,[Or,(0,n.bo)((0,n.Lk)("select",{"onUpdate:modelValue":t[16]||(t[16]=e=>l.query.notifications=e),id:"query-notifications"},Gr,512),[[a.u1,l.query.notifications]])]),(0,n.Lk)("div",Yr,[ed,(0,n.bo)((0,n.Lk)("select",{"onUpdate:modelValue":t[17]||(t[17]=e=>l.query.auto_login=e),id:"query-auto-login"},nd,512),[[a.u1,l.query.auto_login]])]),(0,n.Lk)("div",sd,[ld,(0,n.bo)((0,n.Lk)("select",{"onUpdate:modelValue":t[18]||(t[18]=e=>l.query.verification=e),id:"query-verification"},cd,512),[[a.u1,l.query.verification]])]),ud],32),l.queryResults.length>0?((0,n.uX)(),(0,n.CE)("div",pd,[(0,n.Lk)("table",null,[md,(0,n.Lk)("tbody",null,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(l.queryResults,(e=>((0,n.uX)(),(0,n.CE)("tr",{key:e.id},[(0,n.Lk)("td",null,(0,i.v_)(e.id),1),(0,n.Lk)("td",null,(0,i.v_)(e.font_size),1),(0,n.Lk)("td",null,(0,i.v_)(e.notifications?"啟用":"不啟用"),1),(0,n.Lk)("td",null,(0,i.v_)(e.auto_login?"啟用":"不啟用"),1),(0,n.Lk)("td",null,(0,i.v_)(e.verification?"啟用":"不啟用"),1)])))),128))])])])):((0,n.uX)(),(0,n.CE)("div",hd,"沒有符合條件的偏好設置"))],2)])}var bd={name:"PersonalPreference",data(){return{preferences:{font_size:"",notifications:!1,auto_login:!1,verification:!1},newPreference:{font_size:"medium",notifications:!1,auto_login:!1,verification:!1},query:{font_size:"",notifications:"",auto_login:"",verification:""},queryResults:[],successMessage:!1,showModal:!1,isSidebarActive:!1}},created(){this.loadPreferences()},methods:{loadPreferences(){fetch("http://127.0.0.1:5000/get_preferences").then((e=>e.json())).then((e=>{this.preferences=e}))},updatePreferences(){fetch("http://127.0.0.1:5000/update_preference",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(this.preferences)}).then((e=>{e.ok?this.showSuccessMessage():alert("保存失敗")}))},showAddModal(){this.showModal=!0},closeAddModal(){this.showModal=!1},addPreference(){fetch("http://127.0.0.1:5000/add_preference",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(this.newPreference)}).then((e=>{e.ok?(this.closeAddModal(),this.showSuccessMessage()):alert("新增失敗")}))},deletePreference(){fetch("http://127.0.0.1:5000/delete_preference",{method:"POST"}).then((e=>{e.ok?this.showSuccessMessage():alert("刪除失敗")}))},resetPreferences(){this.loadPreferences()},queryPreferences(){let e="http://127.0.0.1:5000/query_preferences?";this.query.font_size&&(e+=`font_size=${this.query.font_size}&`),this.query.notifications&&(e+=`notifications=${this.query.notifications}&`),this.query.auto_login&&(e+=`auto_login=${this.query.auto_login}&`),this.query.verification&&(e+=`verification=${this.query.verification}&`),fetch(e).then((e=>e.json())).then((e=>{this.queryResults=e}))},showSuccessMessage(){this.successMessage=!0,setTimeout((()=>{this.successMessage=!1}),3e3)}}};const fd=(0,h.A)(bd,[["render",kd],["__scopeId","data-v-881fb4f6"]]);var vd=fd;const Ld=e=>((0,n.Qi)("data-v-58fb158c"),e=e(),(0,n.jt)(),e),gd={class:"profile-container"},Cd=Ld((()=>(0,n.Lk)("h2",null,"個人資料",-1))),yd=Ld((()=>(0,n.Lk)("label",{for:"name"},"姓名：",-1))),wd=Ld((()=>(0,n.Lk)("label",{for:"username"},"帳號：",-1))),_d=Ld((()=>(0,n.Lk)("label",{for:"department"},"部門：",-1))),Md=Ld((()=>(0,n.Lk)("label",{for:"position"},"職位：",-1))),Pd=Ld((()=>(0,n.Lk)("label",{for:"phone"},"電話：",-1))),Ed=Ld((()=>(0,n.Lk)("label",{for:"email"},"電子郵件：",-1))),Rd=Ld((()=>(0,n.Lk)("label",{for:"created"},"建立時間：",-1))),Sd={key:0,id:"editModal",class:"modal"},Ud={class:"modal-content"},Ad=Ld((()=>(0,n.Lk)("h2",null,"編輯個人資料",-1))),Vd=Ld((()=>(0,n.Lk)("label",{for:"modal-name"},"姓名：",-1))),xd=Ld((()=>(0,n.Lk)("label",{for:"modal-username"},"帳號：",-1))),Fd=Ld((()=>(0,n.Lk)("label",{for:"modal-department"},"部門：",-1))),Td=Ld((()=>(0,n.Lk)("label",{for:"modal-position"},"職位：",-1))),$d=Ld((()=>(0,n.Lk)("label",{for:"modal-phone"},"電話：",-1))),Id=Ld((()=>(0,n.Lk)("label",{for:"modal-email"},"電子郵件：",-1)));function Xd(e,t,o,s,l,r){return(0,n.uX)(),(0,n.CE)("div",{class:(0,i.C4)(["profile-content",{shifted:l.isSidebarActive}])},[(0,n.Lk)("div",gd,[Cd,yd,(0,n.bo)((0,n.Lk)("input",{type:"text",id:"name","onUpdate:modelValue":t[0]||(t[0]=e=>l.profile.name=e)},null,512),[[a.Jo,l.profile.name]]),wd,(0,n.bo)((0,n.Lk)("input",{type:"text",id:"username","onUpdate:modelValue":t[1]||(t[1]=e=>l.profile.username=e)},null,512),[[a.Jo,l.profile.username]]),_d,(0,n.bo)((0,n.Lk)("input",{type:"text",id:"department","onUpdate:modelValue":t[2]||(t[2]=e=>l.profile.department=e)},null,512),[[a.Jo,l.profile.department]]),Md,(0,n.bo)((0,n.Lk)("input",{type:"text",id:"position","onUpdate:modelValue":t[3]||(t[3]=e=>l.profile.position=e)},null,512),[[a.Jo,l.profile.position]]),Pd,(0,n.bo)((0,n.Lk)("input",{type:"text",id:"phone","onUpdate:modelValue":t[4]||(t[4]=e=>l.profile.phone=e)},null,512),[[a.Jo,l.profile.phone]]),Ed,(0,n.bo)((0,n.Lk)("input",{type:"text",id:"email","onUpdate:modelValue":t[5]||(t[5]=e=>l.profile.email=e)},null,512),[[a.Jo,l.profile.email]]),Rd,(0,n.bo)((0,n.Lk)("input",{type:"text",id:"created","onUpdate:modelValue":t[6]||(t[6]=e=>l.profile.created=e),disabled:""},null,512),[[a.Jo,l.profile.created]]),(0,n.Lk)("button",{onClick:t[7]||(t[7]=(...e)=>r.openModal&&r.openModal(...e))},"編輯"),(0,n.Lk)("button",{class:"logout-btn",onClick:t[8]||(t[8]=(...e)=>r.logout&&r.logout(...e))},"登出")]),l.showModal?((0,n.uX)(),(0,n.CE)("div",Sd,[(0,n.Lk)("div",Ud,[(0,n.Lk)("span",{class:"close",onClick:t[9]||(t[9]=(...e)=>r.closeModal&&r.closeModal(...e))},"×"),Ad,Vd,(0,n.bo)((0,n.Lk)("input",{type:"text",id:"modal-name","onUpdate:modelValue":t[10]||(t[10]=e=>l.editProfile.name=e)},null,512),[[a.Jo,l.editProfile.name]]),xd,(0,n.bo)((0,n.Lk)("input",{type:"text",id:"modal-username","onUpdate:modelValue":t[11]||(t[11]=e=>l.editProfile.username=e)},null,512),[[a.Jo,l.editProfile.username]]),Fd,(0,n.bo)((0,n.Lk)("input",{type:"text",id:"modal-department","onUpdate:modelValue":t[12]||(t[12]=e=>l.editProfile.department=e)},null,512),[[a.Jo,l.editProfile.department]]),Td,(0,n.bo)((0,n.Lk)("input",{type:"text",id:"modal-position","onUpdate:modelValue":t[13]||(t[13]=e=>l.editProfile.position=e)},null,512),[[a.Jo,l.editProfile.position]]),$d,(0,n.bo)((0,n.Lk)("input",{type:"text",id:"modal-phone","onUpdate:modelValue":t[14]||(t[14]=e=>l.editProfile.phone=e)},null,512),[[a.Jo,l.editProfile.phone]]),Id,(0,n.bo)((0,n.Lk)("input",{type:"text",id:"modal-email","onUpdate:modelValue":t[15]||(t[15]=e=>l.editProfile.email=e)},null,512),[[a.Jo,l.editProfile.email]]),(0,n.Lk)("button",{onClick:t[16]||(t[16]=(...e)=>r.saveProfile&&r.saveProfile(...e))},"保存")])])):(0,n.Q3)("",!0)],2)}var qd={name:"PensonalProfile",data(){return{profile:{name:"John Doe",username:"johndoe123",department:"技術部",position:"系統管理員",phone:"0912345678",email:"johndoe@example.com",created:"2023-01-01"},editProfile:{name:"John Doe",username:"johndoe123",department:"技術部",position:"系統管理員",phone:"0912345678",email:"johndoe@example.com"},showModal:!1,isSidebarActive:!1}},methods:{openModal(){this.editProfile={...this.profile},this.showModal=!0},closeModal(){this.showModal=!1},saveProfile(){this.profile={...this.editProfile},this.closeModal(),alert("個人資料已更新")},logout(){window.location.href="登出成功.html"}}};const Bd=(0,h.A)(qd,[["render",Xd],["__scopeId","data-v-58fb158c"]]);var Dd=Bd;const Jd=[{path:"/",redirect:"/frontend/login"},{path:"/frontend/login",name:"FrontendLogin",component:ae,meta:{hideNavbar:!0,hideSidebar:!0}},{path:"/frontend/register",name:"FrontendRegister",component:Ce,meta:{hideNavbar:!0,hideSidebar:!0}},{path:"/frontend/forgot_password",name:"FrontendForgetPassword",component:Ue,meta:{hideNavbar:!0,hideSidebar:!0}},{path:"/frontend/home",name:"首頁",component:ot},{path:"/frontend/profile",name:"個人資訊",component:mt},{path:"/frontend/accountsettings",name:"帳號設定",component:Mt},{path:"/frontend/changepassword",name:"修改密碼",component:Bt},{path:"/frontend/preferences",name:"偏好設定",component:Co},{path:"/frontend/historydetails",name:"歷史紀錄詳情",component:ra},{path:"/frontend/detail/:id",name:"歷史紀錄詳情",component:ra},{path:"/frontend/history",name:"歷史紀錄",component:zo},{path:"/frontend/reset_password",name:"ResetPassword",component:Pa,meta:{hideNavbar:!0,hideSidebar:!0}},{path:"/backend/login",name:"BackendLogin",component:Na,meta:{hideSidebar:!0}},{path:"/backend/register",name:"BackendRegister",component:rn},{path:"/backend/forgetpassword",name:"BackendForgetPassword",component:fn},{path:"/backend/management",name:"BackendManagement",component:En},{path:"/backend/dashboard",name:"BackendDashboard",component:xn},{path:"/backend/user-management",name:"BackendUserManagement",component:Yn},{path:"/backend/role-management",name:"BackendRoleManagement",component:sl},{path:"/backend/pending_list",name:"BackendPendingList",component:vl},{path:"/backend/edit_user/:userId",name:"BackendEditUser",component:Dl},{path:"/backend/assign_role/:userId",name:"BackendAssignRole",component:ei},{path:"/backend/module-management",name:"BackendModuleManagement",component:Ci},{path:"/backend/create_role",name:"BackendCreateRole",component:ol},{path:"/backend/edit_role/:roleId",name:"BackendEditRole",component:ol},{path:"/backend/create-module",name:"BackendCreateModule",component:vi},{path:"/backend/edit_module/:moduleId",name:"BackendEditModule",component:vi},{path:"/backend/role_permissions/:roleId",name:"BackendRolePermissions",component:xi},{path:"/backend/history",name:"BackendHistory",component:ar},{path:"/backend/preferences",name:"BackendPreference",component:vd},{path:"/backend/profile",name:"BackendProfile",component:Dd}],Nd=(0,B.aE)({history:(0,B.LA)(),routes:Jd});var Wd=Nd,jd=o(782);const Qd=(0,jd.y$)({state:{token:null,user:null},mutations:{setToken(e,t){e.token=t},setUser(e,t){e.user=t}},actions:{setToken({commit:e},t){e("setToken",t)},setUser({commit:e},t){e("setUser",t)}}});var zd=Qd;const Od=(0,a.Ef)(q);Od.use(Wd),Od.use(zd);const Hd=window.location.pathname.startsWith("/admin");Hd?Od.config.globalProperties.$axios=Wo:o.e(950).then(o.bind(o,8950)).then((({library:e})=>{Promise.all([o.e(950),o.e(292)]).then(o.bind(o,292)).then((({FontAwesomeIcon:t})=>{o.e(353).then(o.bind(o,2353)).then((({fas:o})=>{e.add(o),Od.component("font-awesome-icon",t),Od.mount("#app")}))}))})),Hd&&Od.mount("#app")}},t={};function o(a){var n=t[a];if(void 0!==n)return n.exports;var s=t[a]={exports:{}};return e[a].call(s.exports,s,s.exports,o),s.exports}o.m=e,function(){var e=[];o.O=function(t,a,n,s){if(!a){var l=1/0;for(c=0;c<e.length;c++){a=e[c][0],n=e[c][1],s=e[c][2];for(var i=!0,r=0;r<a.length;r++)(!1&s||l>=s)&&Object.keys(o.O).every((function(e){return o.O[e](a[r])}))?a.splice(r--,1):(i=!1,s<l&&(l=s));if(i){e.splice(c--,1);var d=n();void 0!==d&&(t=d)}}return t}s=s||0;for(var c=e.length;c>0&&e[c-1][2]>s;c--)e[c]=e[c-1];e[c]=[a,n,s]}}(),function(){o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,{a:t}),t}}(),function(){o.d=function(e,t){for(var a in t)o.o(t,a)&&!o.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){o.f={},o.e=function(e){return Promise.all(Object.keys(o.f).reduce((function(t,a){return o.f[a](e,t),t}),[]))}}(),function(){o.u=function(e){return"js/"+e+"."+{292:"5935d0ba",353:"8e771558",950:"d2dccc25"}[e]+".js"}}(),function(){o.miniCssF=function(e){}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={},t="admin-frontend:";o.l=function(a,n,s,l){if(e[a])e[a].push(n);else{var i,r;if(void 0!==s)for(var d=document.getElementsByTagName("script"),c=0;c<d.length;c++){var u=d[c];if(u.getAttribute("src")==a||u.getAttribute("data-webpack")==t+s){i=u;break}}i||(r=!0,i=document.createElement("script"),i.charset="utf-8",i.timeout=120,o.nc&&i.setAttribute("nonce",o.nc),i.setAttribute("data-webpack",t+s),i.src=a),e[a]=[n];var p=function(t,o){i.onerror=i.onload=null,clearTimeout(m);var n=e[a];if(delete e[a],i.parentNode&&i.parentNode.removeChild(i),n&&n.forEach((function(e){return e(o)})),t)return t(o)},m=setTimeout(p.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=p.bind(null,i.onerror),i.onload=p.bind(null,i.onload),r&&document.head.appendChild(i)}}}(),function(){o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){o.p="/"}(),function(){var e={524:0};o.f.j=function(t,a){var n=o.o(e,t)?e[t]:void 0;if(0!==n)if(n)a.push(n[2]);else{var s=new Promise((function(o,a){n=e[t]=[o,a]}));a.push(n[2]=s);var l=o.p+o.u(t),i=new Error,r=function(a){if(o.o(e,t)&&(n=e[t],0!==n&&(e[t]=void 0),n)){var s=a&&("load"===a.type?"missing":a.type),l=a&&a.target&&a.target.src;i.message="Loading chunk "+t+" failed.\n("+s+": "+l+")",i.name="ChunkLoadError",i.type=s,i.request=l,n[1](i)}};o.l(l,r,"chunk-"+t,t)}},o.O.j=function(t){return 0===e[t]};var t=function(t,a){var n,s,l=a[0],i=a[1],r=a[2],d=0;if(l.some((function(t){return 0!==e[t]}))){for(n in i)o.o(i,n)&&(o.m[n]=i[n]);if(r)var c=r(o)}for(t&&t(a);d<l.length;d++)s=l[d],o.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return o.O(c)},a=self["webpackChunkadmin_frontend"]=self["webpackChunkadmin_frontend"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=o.O(void 0,[504],(function(){return o(8764)}));a=o.O(a)})();
//# sourceMappingURL=app.aea5b927.js.map